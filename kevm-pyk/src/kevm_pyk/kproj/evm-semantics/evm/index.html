<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
/>
<meta
  name="description"
  content="K Semantics of the Ethereum Virtual Machine (EVM)"
/>
<meta
  name="keywords"
  content="runtime, verification, rv, k, ethereum virtual machine, evm"
/>
<meta name="author" content="EVM Semantics | Runtime Verification Inc" />
<meta name="robots" content="index, follow" />

<!--favicon icon-->
<link rel="icon" type="image/png" href="../../../../../../assets/img/favicon.ico" />

<title>KEVM: Semantics of EVM in K | Runtime Verification, Inc. </title>

<link rel="canonical" href="https://jellopaper.org/kevm-pyk/src/kevm_pyk/kproj/evm-semantics/evm/" />

<!--web fonts-->
<link
  href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css?family=Lora:400i"
  rel="stylesheet"
/>

<link
  href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"
  rel="stylesheet"
/>

<link href="../../../../../../assets/css/index.css" rel="stylesheet" />

<!--[if (gt IE 9) |!(IE)]><!-->
<!--<link rel="stylesheet" href="/assets/vendor/custom-nav/css/effects/fade-menu.css"/>-->
<!-- <link rel="stylesheet" href="../../../../../../assets/k/vl-nav/css/effects/slide-menu.css" /> -->
<!--<![endif]-->

  </head>

  <body>
<header
  class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar"
>
  <a class="logo-link" href="../../../../../../index.html"> EVM Semantics </a>
  <ul class="navbar-nav ml-md-auto">
    <li class="nav-item">
      <a
        class="nav-link pl-2 pr-1 mx-1 py-3 my-n2"
        href="https://github.com/runtimeverification/evm-semantics"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
    </li>
  </ul>
  <!--
  <a
    class="btn btn-rv-blue d-none d-lg-inline-block mb-3 mb-md-0 ml-md-3"
    href="../../../../../../downloads"
    >Download</a
  >
  -->
</header>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 bd-sidebar mb-3">
  <form
    role="search"
    class="bd-search d-flex align-items-center justify-content-between"
  >
    <input
      type="search"
      class="form-control"
      placeholder="Search..."
      aria-label="Search for..."
      autocomplete="false"
      id="search-box"
    />
    <button
      class="btn bd-search-docs-toggle d-md-none p-0 ml-3 collapsed"
      type="button"
      aria-label="Toggle docs navigation"
      style="font-size: 1.4rem"
    >
      <i class="fas fa-bars"></i>
    </button>
  </form>
  <nav class="collapse bd-links" aria-label="Main navigation">
    <div class="bd-toc-item">
      <a class="bd-toc-link" href="../../../../../../">Homepage</a>
      <a class="bd-toc-link" href="../../../../../../INSTALL/">Install</a>
    </div>
  </nav>
</div>

        <main
          class="col-12 col-md-6 col-xl-8 py-md-3 pl-md-5 bd-content"
          role="main"
        >
          <div class="markdown-preview"><html><head></head><body><h1 id="evm-execution">EVM Execution</h1>
<h3 id="overview">Overview</h3>
<p>The EVM is a stack machine over some simple opcodes.
Most of the opcodes are "local" to the execution state of the machine, but some of them must interact with the world state.
This file only defines the local execution operations, the file <code>driver.md</code> will define the interactions with the world state.</p>
<pre><code class="language-k"><span class="token keyword">requires</span> <span class="token string">"data.md"</span>
<span class="token keyword">requires</span> <span class="token string">"network.md"</span>
<span class="token keyword">requires</span> <span class="token string">"gas.md"</span>
<span class="token keyword">requires</span> <span class="token string">"requests.md"</span>

<span class="token keyword">module</span> EVM
    <span class="token keyword">imports</span> STRING
    <span class="token keyword">imports</span> EVM<span class="token operator">-</span>DATA
    <span class="token keyword">imports</span> NETWORK
    <span class="token keyword">imports</span> GAS
    <span class="token keyword">imports</span> EVM<span class="token operator">-</span>REQUESTS
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>The configuration has cells for the current account id, the current opcode, the program counter, the current gas, the gas price, the current program, the word stack, and the local memory.
In addition, there are cells for the callstack and execution substate.</p>
<p>We've broken up the configuration into two components; those parts of the state that mutate during execution of a single transaction and those that are static throughout.
In the comments next to each cell, we've marked which component of the YellowPaper state corresponds to each cell.</p>
<pre><code class="language-k">    <span class="token keyword">configuration</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kevm</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> $PGM<span class="token punctuation">:</span>EthereumSimulation <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exit-code</span> <span class="token attr-name">exit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exit-code</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mode</span><span class="token punctuation">&gt;</span></span> $MODE<span class="token punctuation">:</span>Mode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mode</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> $SCHEDULE<span class="token punctuation">:</span>Schedule <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> $USEGAS<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ethereum</span><span class="token punctuation">&gt;</span></span>

          <span class="token comment">// EVM Specific</span>
          <span class="token comment">// ============</span>

          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>evm</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Mutable during a single transaction</span>
            <span class="token comment">// -----------------------------------</span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>          <span class="token punctuation">.</span>Bytes      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>           <span class="token comment">// H_RETURN</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span>      <span class="token punctuation">.</span>StatusCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callStack</span><span class="token punctuation">&gt;</span></span>       <span class="token punctuation">.</span>List       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callStack</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interimStates</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>List       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>interimStates</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Set        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callState</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jumpDests</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jumpDests</span><span class="token punctuation">&gt;</span></span>

              <span class="token comment">// I_*</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>        <span class="token punctuation">.</span>Account <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>                    <span class="token comment">// I_a</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span>    <span class="token punctuation">.</span>Account <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">// I_s</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">.</span>Bytes   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>              <span class="token comment">// I_d</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>             <span class="token comment">// I_v</span>

              <span class="token comment">// \mu_*</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>WordStack <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>           <span class="token comment">// \mu_s</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span>    <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>            <span class="token comment">// \mu_m</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>                  <span class="token comment">// \mu_pc</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span><span class="token punctuation">:</span>Gas      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>                 <span class="token comment">// \mau_g</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>  <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// \mu_i</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span>     <span class="token number">0</span><span class="token punctuation">:</span>Gas      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>

              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>static</span><span class="token punctuation">&gt;</span></span>    <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>static</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callState</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>versionedHashes</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>versionedHashes</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// A_* (execution substate)</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>substate</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>     <span class="token punctuation">.</span>Set  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>            <span class="token comment">// A_s</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span><span class="token punctuation">&gt;</span></span>              <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>                     <span class="token comment">// A_l</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span>           <span class="token number">0</span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>                  <span class="token comment">// A_r</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Set  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">.</span>Map  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">.</span>Set  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>substate</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Immutable during a single transaction</span>
            <span class="token comment">// -------------------------------------</span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasPrice</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasPrice</span><span class="token punctuation">&gt;</span></span>                   <span class="token comment">// I_p</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origin</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>Account <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origin</span><span class="token punctuation">&gt;</span></span>                     <span class="token comment">// I_o</span>

            <span class="token comment">// I_H* (block information)</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blockhashes</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blockhashes</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span>   <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousHash</span><span class="token punctuation">&gt;</span></span>     <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousHash</span><span class="token punctuation">&gt;</span></span>     <span class="token comment">// I_Hp</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ommersHash</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ommersHash</span><span class="token punctuation">&gt;</span></span>       <span class="token comment">// I_Ho</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>         <span class="token comment">// I_Hc</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stateRoot</span><span class="token punctuation">&gt;</span></span>        <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stateRoot</span><span class="token punctuation">&gt;</span></span>        <span class="token comment">// I_Hr</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionsRoot</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transactionsRoot</span><span class="token punctuation">&gt;</span></span> <span class="token comment">// I_Ht</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>receiptsRoot</span><span class="token punctuation">&gt;</span></span>     <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>receiptsRoot</span><span class="token punctuation">&gt;</span></span>     <span class="token comment">// I_He</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logsBloom</span><span class="token punctuation">&gt;</span></span>        <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logsBloom</span><span class="token punctuation">&gt;</span></span>        <span class="token comment">// I_Hb</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>difficulty</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>difficulty</span><span class="token punctuation">&gt;</span></span>       <span class="token comment">// I_Hd</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span>           <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number</span><span class="token punctuation">&gt;</span></span>           <span class="token comment">// I_Hi</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasLimit</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasLimit</span><span class="token punctuation">&gt;</span></span>         <span class="token comment">// I_Hl</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasUsed</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span><span class="token punctuation">:</span>Gas  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasUsed</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// I_Hg</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timestamp</span><span class="token punctuation">&gt;</span></span>        <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timestamp</span><span class="token punctuation">&gt;</span></span>        <span class="token comment">// I_Hs</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>extraData</span><span class="token punctuation">&gt;</span></span>        <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>extraData</span><span class="token punctuation">&gt;</span></span>        <span class="token comment">// I_Hx</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mixHash</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mixHash</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// I_Hm</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blockNonce</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blockNonce</span><span class="token punctuation">&gt;</span></span>       <span class="token comment">// I_Hn</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>baseFee</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>baseFee</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsRoot</span><span class="token punctuation">&gt;</span></span>  <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsRoot</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>      <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span>    <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beaconRoot</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beaconRoot</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requestsRoot</span><span class="token punctuation">&gt;</span></span>     <span class="token number">0</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requestsRoot</span><span class="token punctuation">&gt;</span></span>

              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ommerBlockHeaders</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span> <span class="token punctuation">.</span>JSONs <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ommerBlockHeaders</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>

          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>evm</span><span class="token punctuation">&gt;</span></span>

          <span class="token comment">// Ethereum Network</span>
          <span class="token comment">// ================</span>

          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>network</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Chain identifier</span>
            <span class="token comment">// ----------------</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>chainID</span><span class="token punctuation">&gt;</span></span> $CHAINID<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>chainID</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Accounts Record</span>
            <span class="token comment">// ---------------</span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span> <span class="token attr-name">multiplicity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span>           <span class="token number">0</span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>             <span class="token punctuation">.</span>Bytes<span class="token punctuation">:</span>AccountCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span>          <span class="token punctuation">.</span>Map               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origStorage</span><span class="token punctuation">&gt;</span></span>      <span class="token punctuation">.</span>Map               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origStorage</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transientStorage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Map               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transientStorage</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span>            <span class="token number">0</span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Transactions Record</span>
            <span class="token comment">// -------------------</span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txOrder</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txOrder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>messages</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span> <span class="token attr-name">multiplicity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txNonce</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txNonce</span><span class="token punctuation">&gt;</span></span>       <span class="token comment">// T_n</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txGasPrice</span><span class="token punctuation">&gt;</span></span>    <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txGasPrice</span><span class="token punctuation">&gt;</span></span>    <span class="token comment">// T_p</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txGasLimit</span><span class="token punctuation">&gt;</span></span>    <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txGasLimit</span><span class="token punctuation">&gt;</span></span>    <span class="token comment">// T_g</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">&gt;</span></span>            <span class="token punctuation">.</span>Account   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">&gt;</span></span>            <span class="token comment">// T_t</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>         <span class="token comment">// T_v</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sigV</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sigV</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// T_w</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sigR</span><span class="token punctuation">&gt;</span></span>          <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sigR</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// T_r</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sigS</span><span class="token punctuation">&gt;</span></span>          <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sigS</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// T_s</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span><span class="token punctuation">&gt;</span></span>          <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">&gt;</span></span>          <span class="token comment">// T_i/T_e</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txAccess</span><span class="token punctuation">&gt;</span></span>      <span class="token punctuation">[</span> <span class="token punctuation">.</span>JSONs <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txAccess</span><span class="token punctuation">&gt;</span></span>      <span class="token comment">// T_a</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txChainID</span><span class="token punctuation">&gt;</span></span>     <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txChainID</span><span class="token punctuation">&gt;</span></span>     <span class="token comment">// T_c</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPriorityFee</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPriorityFee</span><span class="token punctuation">&gt;</span></span> <span class="token comment">// T_f</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txMaxFee</span><span class="token punctuation">&gt;</span></span>      <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txMaxFee</span><span class="token punctuation">&gt;</span></span>      <span class="token comment">// T_m</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txType</span><span class="token punctuation">&gt;</span></span>        <span class="token punctuation">.</span>TxType    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txType</span><span class="token punctuation">&gt;</span></span>        <span class="token comment">// T_x</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txMaxBlobFee</span><span class="token punctuation">&gt;</span></span>  <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txMaxBlobFee</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txAuthList</span><span class="token punctuation">&gt;</span></span>    <span class="token punctuation">.</span>List      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txAuthList</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>messages</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">// Withdrawals Record</span>
            <span class="token comment">// ------------------</span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsOrder</span><span class="token punctuation">&gt;</span></span>   <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsOrder</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawals</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawal</span> <span class="token attr-name">multiplicity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalID</span><span class="token punctuation">&gt;</span></span>   <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalID</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>index</span><span class="token punctuation">&gt;</span></span>          <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>index</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>validatorIndex</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>validatorIndex</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>address</span><span class="token punctuation">&gt;</span></span>        <span class="token punctuation">.</span>Account <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>address</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>amount</span><span class="token punctuation">&gt;</span></span>         <span class="token number">0</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>amount</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawal</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawals</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requests</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>depositRequests</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>depositRequests</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requests</span><span class="token punctuation">&gt;</span></span>

          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>network</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ethereum</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kevm</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> EthereumSimulation
 <span class="token comment">// -------------------------</span>
</code></pre>
<h2 id="modal-semantics">Modal Semantics</h2>
<p>Our semantics is modal, with the initial mode being set on the command line via <code>-cMODE=EXECMODE</code>.</p>
<ul>
<li><code>NORMAL</code> executes as a client on the network would.</li>
<li><code>VMTESTS</code> skips <code>CALL*</code> and <code>CREATE</code> operations.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> Mode <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"NORMAL"</span>  <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>NORMAL<span class="token punctuation">)</span> <span class="token punctuation">]</span>
                  <span class="token operator">|</span> <span class="token string">"VMTESTS"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>VMTESTS<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------</span>
</code></pre>
<h2 id="state-stacks">State Stacks</h2>
<h3 id="the-callstack">The CallStack</h3>
<p>The <code>callStack</code> cell stores a list of previous VM execution states.</p>
<ul>
<li><code>#pushCallStack</code> saves a copy of VM execution state on the <code>callStack</code>.</li>
<li><code>#popCallStack</code> restores the top element of the <code>callStack</code>.</li>
<li><code>#dropCallStack</code> removes the top element of the <code>callStack</code>.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#pushCallStack"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #pushCallStack <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callStack</span><span class="token punctuation">&gt;</span></span> STACK <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callState</span><span class="token punctuation">&gt;</span></span> CALLSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callState</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> STACK <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callState</span><span class="token punctuation">&gt;</span></span> CALLSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callState</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#popCallStack"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #popCallStack <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callStack</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callState</span><span class="token punctuation">&gt;</span></span> CALLSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callState</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callState</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> CALLSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callState</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#dropCallStack"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #dropCallStack <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callStack</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callStack</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="the-statestack">The StateStack</h3>
<p>The <code>interimStates</code> cell stores a list of previous world states.</p>
<ul>
<li><code>#pushWorldState</code> stores a copy of the current accounts and the substate at the top of the <code>interimStates</code> cell.</li>
<li><code>#popWorldState</code> restores the top element of the <code>interimStates</code>.</li>
<li><code>#dropWorldState</code> removes the top element of the <code>interimStates</code>.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> Accounts <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"{"</span> AccountsCell <span class="token string">"|"</span> SubstateCell <span class="token string">"}"</span>
 <span class="token comment">// ---------------------------------------------------------</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#pushWorldState"</span>
 <span class="token comment">// ---------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #pushWorldState <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interimStates</span><span class="token punctuation">&gt;</span></span> STATES <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span> ACCTDATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span> <span class="token operator">|</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>substate</span><span class="token punctuation">&gt;</span></span> SUBSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>substate</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span> STATES <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>interimStates</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span> ACCTDATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>substate</span><span class="token punctuation">&gt;</span></span> SUBSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>substate</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#popWorldState"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #popWorldState <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interimStates</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span> ACCTDATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span> <span class="token operator">|</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>substate</span><span class="token punctuation">&gt;</span></span> SUBSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>substate</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>interimStates</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTDATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>substate</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> SUBSTATE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>substate</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#dropWorldState"</span>
 <span class="token comment">// ---------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #dropWorldState <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interimStates</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>interimStates</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="control-flow">Control Flow</h2>
<h3 id="exception-based">Exception Based</h3>
<ul>
<li><code>#halt</code> indicates end of execution.
It will consume anything related to the current computation behind it on the <code>&lt;k&gt;</code> cell.</li>
<li><code>#end_</code> sets the <code>statusCode</code> and the program counter of the last executed opcode, then halts execution.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#halt"</span>           <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>halt<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#end"</span> StatusCode <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span> <span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #end SC <span class="token operator">=&gt;</span> #halt <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> SC <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> <span class="token punctuation">(</span>_<span class="token punctuation">:</span><span class="token keyword">Int</span>    <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> <span class="token punctuation">(</span>_<span class="token punctuation">:</span>OpCode <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="opcode-execution">OpCode Execution</h2>
<h3 id="execution-macros">Execution Macros</h3>
<ul>
<li><code>#lookupOpCode</code> reads an <code>OpCode</code> from the program <code>Bytes</code> if the program-counter is within the bounds of the program, meaning that it points to an actual opcode.
It will return <code>.NoOpCode</code> otherwise.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> MaybeOpCode <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">".NoOpCode"</span> <span class="token operator">|</span> OpCode

    <span class="token keyword">syntax</span> MaybeOpCode <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#lookupOpCode"</span> <span class="token string">"("</span> Bytes <span class="token string">","</span> <span class="token keyword">Int</span> <span class="token string">","</span> Schedule <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #lookupOpCode<span class="token punctuation">(</span>BA<span class="token punctuation">,</span> I<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #dasmOpCode<span class="token punctuation">(</span>BA<span class="token punctuation">[</span>I<span class="token punctuation">]</span><span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> I andBool I &lt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>BA<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #lookupOpCode<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>NoOpCode <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<ul>
<li><code>#execute</code> loads the next opcode.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#execute"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>execute<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>halt<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> <span class="token punctuation">(</span>#execute <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>step<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #next <span class="token punctuation">[</span> #lookupOpCode<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> PCOUNT<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #execute <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span> PGM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span> PCOUNT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="single-step">Single Step</h3>
<p>If the program-counter points to an actual opcode, it's loaded into the <code>#next [_]</code> operator.
If <code>.NoOpCode</code> is loaded into <code>#next [_]</code>, then it means that there is no next opcode and the execution will halt with an <code>EVMC_SUCCESS</code> status code.
The <code>#next [_]</code> operator initiates execution by:</p>
<ol>
<li>checking if there will be a stack over/underflow, or a static mode violation,</li>
<li>calculate any address conversions needed for items on the wordstack,</li>
<li>executing the opcode (which includes any gas deduction needed), and</li>
<li>adjusting the program counter.</li>
</ol>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#next"</span> <span class="token string">"["</span> MaybeOpCode <span class="token string">"]"</span>
 <span class="token comment">// -------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #next <span class="token punctuation">[</span> <span class="token punctuation">.</span>NoOpCode <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #next <span class="token punctuation">[</span> OP<span class="token punctuation">:</span>OpCode <span class="token punctuation">]</span>
          <span class="token operator">=&gt;</span> #addr <span class="token punctuation">[</span> OP <span class="token punctuation">]</span>
          <span class="token operator">~&gt;</span> #exec <span class="token punctuation">[</span> OP <span class="token punctuation">]</span>
          <span class="token operator">~&gt;</span> #pc   <span class="token punctuation">[</span> OP <span class="token punctuation">]</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>static</span><span class="token punctuation">&gt;</span></span> STATIC<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>static</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span> #stackUnderflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> orBool #stackOverflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> <span class="token punctuation">)</span>
       andBool notBool <span class="token punctuation">(</span> STATIC andBool #changesState<span class="token punctuation">(</span>OP<span class="token punctuation">,</span> WS<span class="token punctuation">)</span> <span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #next <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #end EVMC_STACK_UNDERFLOW <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #stackUnderflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #next <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #end EVMC_STACK_OVERFLOW <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #stackOverflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #next <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #end EVMC_STATIC_MODE_VIOLATION <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>static</span><span class="token punctuation">&gt;</span></span> STATIC<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>static</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> STATIC andBool #changesState<span class="token punctuation">(</span>OP<span class="token punctuation">,</span> WS<span class="token punctuation">)</span>
       andBool notBool <span class="token punctuation">(</span> #stackUnderflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> orBool #stackOverflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre>
<h3 id="exceptional-checks">Exceptional Checks</h3>
<ul>
<li><code>#stackNeeded</code> is how many arguments that opcode will need off the top of the stack.</li>
<li><code>#stackAdded</code> is how many arguments that opcode will push onto the top of the stack.</li>
<li><code>#stackDelta</code> is the delta the stack will have after the opcode executes.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #stackUnderflow <span class="token punctuation">(</span> WordStack <span class="token punctuation">,</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#stackUnderflow<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">macro</span><span class="token punctuation">]</span>
                  <span class="token operator">|</span> #stackOverflow  <span class="token punctuation">(</span> WordStack <span class="token punctuation">,</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#stackOverflow<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">macro</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #stackUnderflow<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">:</span>OpCode<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #sizeWordStack<span class="token punctuation">(</span>WS<span class="token punctuation">)</span> &lt;<span class="token keyword">Int</span> #stackNeeded<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #stackOverflow <span class="token punctuation">(</span>WS<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>#stackDelta<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span><span class="token punctuation">)</span> andBool <span class="token punctuation">(</span>#sizeWordStack<span class="token punctuation">(</span>WS<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> #stackDelta<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">1024</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #stackNeeded <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#stackNeeded<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_POP<span class="token punctuation">:</span>PushOp<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_IOP<span class="token punctuation">:</span>InvalidOp<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_NOP<span class="token punctuation">:</span>NullStackOp<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_UOP<span class="token punctuation">:</span>UnStackOp<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>BOP<span class="token punctuation">:</span>BinStackOp<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token number">2</span> <span class="token keyword">requires</span> notBool isLogOp<span class="token punctuation">(</span>BOP<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_TOP<span class="token punctuation">:</span>TernStackOp<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">3</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_QOP<span class="token punctuation">:</span>QuadStackOp<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">4</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>DUP<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> N
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>SWAP<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> N <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>LOG<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> N <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">2</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>_CSOP<span class="token punctuation">:</span>CallSixOp<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token number">6</span>
    <span class="token keyword">rule</span> #stackNeeded<span class="token punctuation">(</span>COP<span class="token punctuation">:</span>CallOp<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token number">7</span> <span class="token keyword">requires</span> notBool isCallSixOp<span class="token punctuation">(</span>COP<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #stackAdded <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#stackAdded<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>CALLDATACOPY<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>RETURNDATACOPY<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>CODECOPY<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>EXTCODECOPY<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>POP<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>MSTORE<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>MSTORE8<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>SSTORE<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>JUMP<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>JUMPI<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>JUMPDEST<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>STOP<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>RETURN<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>REVERT<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>SELFDESTRUCT<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>PUSH<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>LOG<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>SWAP<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> N <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>DUP<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> N <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>_IOP<span class="token punctuation">:</span>InvalidOp<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #stackAdded<span class="token punctuation">(</span>_OP<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #stackDelta <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#stackDelta<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #stackDelta<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #stackAdded<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> #stackNeeded<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>
</code></pre>
<ul>
<li><code>#changesState</code> is true if the given opcode will change <code>&lt;network&gt;</code> state given the arguments.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #changesState <span class="token punctuation">(</span> OpCode <span class="token punctuation">,</span> WordStack <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#changesState<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------</span>
</code></pre>
<pre><code class="language-k">    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>CALL         <span class="token punctuation">,</span> _ <span class="token punctuation">:</span> _ <span class="token punctuation">:</span> VALUE <span class="token punctuation">:</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>  <span class="token keyword">requires</span> VALUE <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>LOG<span class="token punctuation">(</span>_<span class="token punctuation">)</span>       <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>SSTORE       <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>CREATE       <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>CREATE2      <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>SELFDESTRUCT <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>TSTORE       <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #changesState<span class="token punctuation">(</span>_            <span class="token punctuation">,</span> _<span class="token punctuation">)</span>                 <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h3 id="execution-step">Execution Step</h3>
<ul>
<li><code>#exec</code> will load the arguments of the opcode (it assumes <code>#stackNeeded?</code> is accurate and has been called) and trigger the subsequent operations.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#exec"</span> <span class="token string">"["</span> OpCode <span class="token string">"]"</span>
 <span class="token comment">// --------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> IOP<span class="token punctuation">:</span>InvalidOp <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> IOP <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> OP <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> OP <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> isNullStackOp<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> orBool isPushOp<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>
</code></pre>
<p>Here we load the correct number of arguments from the <code>wordStack</code> based on the sort of the opcode.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem  <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> OpCode
    <span class="token keyword">syntax</span> OpCode <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> NullStackOp <span class="token operator">|</span> UnStackOp <span class="token operator">|</span> BinStackOp <span class="token operator">|</span> TernStackOp <span class="token operator">|</span> QuadStackOp
                    <span class="token operator">|</span> InvalidOp <span class="token operator">|</span> StackOp <span class="token operator">|</span> InternalOp <span class="token operator">|</span> CallOp <span class="token operator">|</span> CallSixOp <span class="token operator">|</span> PushOp
 <span class="token comment">// --------------------------------------------------------------------------------</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> UnStackOp   <span class="token keyword">Int</span>
                        <span class="token operator">|</span> BinStackOp  <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> TernStackOp <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> QuadStackOp <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
 <span class="token comment">// -------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> UOP<span class="token punctuation">:</span>UnStackOp   <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> UOP <span class="token punctuation">,</span> UOP W0          <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> UOP W0          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> WS                <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> BOP<span class="token punctuation">:</span>BinStackOp  <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> BOP <span class="token punctuation">,</span> BOP W0 W1       <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> BOP W0 W1       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> W1 <span class="token punctuation">:</span> WS           <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> TOP<span class="token punctuation">:</span>TernStackOp <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> TOP <span class="token punctuation">,</span> TOP W0 W1 W2    <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> TOP W0 W1 W2    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> W1 <span class="token punctuation">:</span> W2 <span class="token punctuation">:</span> WS      <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> QOP<span class="token punctuation">:</span>QuadStackOp <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> QOP <span class="token punctuation">,</span> QOP W0 W1 W2 W3 <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> QOP W0 W1 W2 W3 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> W1 <span class="token punctuation">:</span> W2 <span class="token punctuation">:</span> W3 <span class="token punctuation">:</span> WS <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p><code>StackOp</code> is used for opcodes which require a large portion of the stack.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> StackOp WordStack
 <span class="token comment">// ---------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> SO<span class="token punctuation">:</span>StackOp <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> SO <span class="token punctuation">,</span> SO WS <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> SO WS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>The <code>CallOp</code> opcodes all interpret their second argument as an address.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> CallSixOp <span class="token keyword">Int</span> <span class="token keyword">Int</span>     <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> CallOp    <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
 <span class="token comment">// -----------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> CSO<span class="token punctuation">:</span>CallSixOp <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> CSO <span class="token punctuation">,</span> CSO W0 W1    W2 W3 W4 W5 <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> CSO W0 W1    W2 W3 W4 W5 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> W1 <span class="token punctuation">:</span> W2 <span class="token punctuation">:</span> W3 <span class="token punctuation">:</span> W4 <span class="token punctuation">:</span> W5 <span class="token punctuation">:</span> WS      <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #exec <span class="token punctuation">[</span> CO<span class="token punctuation">:</span>CallOp     <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gas <span class="token punctuation">[</span> CO  <span class="token punctuation">,</span> CO  W0 W1 W2 W3 W4 W5 W6 <span class="token punctuation">]</span> <span class="token operator">~&gt;</span> CO  W0 W1 W2 W3 W4 W5 W6 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> W0 <span class="token punctuation">:</span> W1 <span class="token punctuation">:</span> W2 <span class="token punctuation">:</span> W3 <span class="token punctuation">:</span> W4 <span class="token punctuation">:</span> W5 <span class="token punctuation">:</span> W6 <span class="token punctuation">:</span> WS <span class="token operator">=&gt;</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="address-conversion">Address Conversion</h3>
<p>Some opcodes require accessing elements of the state at different addresses.
We make sure the given arguments (to be interpreted as addresses) are with 160 bits ahead of time.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#addr"</span> <span class="token string">"["</span> OpCode <span class="token string">"]"</span>
 <span class="token comment">// --------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #addr <span class="token punctuation">[</span> OP<span class="token punctuation">:</span>OpCode <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>W0 <span class="token operator">=&gt;</span> #addr<span class="token punctuation">(</span>W0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> _WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> isAddr1Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #addr <span class="token punctuation">[</span> OP<span class="token punctuation">:</span>OpCode <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> _W0 <span class="token punctuation">:</span> <span class="token punctuation">(</span>W1 <span class="token operator">=&gt;</span> #addr<span class="token punctuation">(</span>W1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> _WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> isAddr2Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #addr <span class="token punctuation">[</span> OP<span class="token punctuation">:</span>OpCode <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span> isAddr1Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> orBool isAddr2Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> <span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isAddr1Op <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isAddr1Op<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                  <span class="token operator">|</span> isAddr2Op <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isAddr2Op<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>BALANCE<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>SELFDESTRUCT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>EXTCODEHASH<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>EXTCODESIZE<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>EXTCODECOPY<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr1Op<span class="token punctuation">(</span>_<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> isAddr2Op<span class="token punctuation">(</span>_<span class="token punctuation">:</span>CallOp<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr2Op<span class="token punctuation">(</span>_<span class="token punctuation">:</span>CallSixOp<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> isAddr2Op<span class="token punctuation">(</span>_<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h3 id="program-counter">Program Counter</h3>
<p>All operators except for <code>PUSH</code> and <code>JUMP*</code> increment the program counter by 1.
The arguments to <code>PUSH</code> must be skipped over (as they are inline), and the opcode <code>JUMP</code> already affects the program counter in the correct way.</p>
<ul>
<li><code>#pc</code> calculates the next program counter of the given operator.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#pc"</span> <span class="token string">"["</span> OpCode <span class="token string">"]"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>pc<span class="token punctuation">.</span>inc<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #pc <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span> PCOUNT <span class="token operator">=&gt;</span> PCOUNT <span class="token operator">+</span><span class="token keyword">Int</span> #widthOp<span class="token punctuation">(</span>OP<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #widthOp <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#widthOp<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #widthOp<span class="token punctuation">(</span>PUSH<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token operator">+</span><span class="token keyword">Int</span> N
    <span class="token keyword">rule</span> #widthOp<span class="token punctuation">(</span>_<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token number">1</span>        <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<p>After executing a transaction, it's necessary to have the effect of the substate log recorded.</p>
<ul>
<li><code>#finalizeStorage</code> updates the origStorage cell with the new values of storage.</li>
<li><code>#finalizeTx</code> makes the substate log actually have an effect on the state.</li>
<li><code>#deleteAccounts</code> deletes the accounts specified by the self destruct list.</li>
<li><code>#finalizeWithdrawals</code> increases the balance of the <code>address</code> specified by the <code>amount</code> given, for each withdrawal.</li>
<li><code>#gweiToWei</code> does the conversion from GWEI to WEI.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #gweiToWei <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#gweiToWei<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------</span>
   <span class="token keyword">rule</span> #gweiToWei<span class="token punctuation">(</span>V<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> V <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token number">10</span> <span class="token operator">^</span><span class="token keyword">Int</span> <span class="token number">9</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#finalizeWithdrawals"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#finalizeWithdrawals<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeWithdrawals <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeWithdrawals <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>WDID<span class="token punctuation">)</span> LS <span class="token operator">=&gt;</span> LS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawal</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalID</span><span class="token punctuation">&gt;</span></span> WDID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>address</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>address</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>amount</span><span class="token punctuation">&gt;</span></span> VALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>amount</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawal</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> B <span class="token operator">=&gt;</span> B <span class="token operator">+</span><span class="token keyword">Int</span> #gweiToWei<span class="token punctuation">(</span>VALUE<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #newAccount ACCT<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #finalizeWithdrawals <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>WDID<span class="token punctuation">)</span> _ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalsPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawal</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalID</span><span class="token punctuation">&gt;</span></span> WDID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>address</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>address</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawal</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #finalizeStorage <span class="token punctuation">(</span> List <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#finalizeStorage<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeStorage<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> STORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origStorage</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> STORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transientStorage</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Map <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transientStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeStorage<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #newAccount ACCT<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #finalizeStorage<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> _ACCTS<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #finalizeTx <span class="token punctuation">(</span> <span class="token keyword">Bool</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>   <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#finalizeTx<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> #deleteAccounts <span class="token punctuation">(</span> List <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#deleteAccounts<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #finalizeStorage<span class="token punctuation">(</span>Set2List<span class="token punctuation">(</span>SetItem<span class="token punctuation">(</span>MINER<span class="token punctuation">)</span> <span class="token operator">|</span>Set ACCTS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedStorage</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Map <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token operator">=&gt;</span> G<span class="token operator">*</span><span class="token punctuation">(</span>GAVAIL<span class="token punctuation">,</span> GLIMIT<span class="token punctuation">,</span> REFUND<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span> REFUND <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>MSGID<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span> MSGID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txGasLimit</span><span class="token punctuation">&gt;</span></span> GLIMIT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txGasLimit</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> REFUND <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>baseFee</span><span class="token punctuation">&gt;</span></span> BFEE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>baseFee</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origin</span><span class="token punctuation">&gt;</span></span> ORG <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origin</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasUsed</span><span class="token punctuation">&gt;</span></span> GUSED <span class="token operator">=&gt;</span> GUSED <span class="token operator">+</span>Gas maxInt<span class="token punctuation">(</span>GLIMIT <span class="token operator">-</span><span class="token keyword">Int</span> GAVAIL<span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span> BLOB_GAS_USED <span class="token operator">=&gt;</span> #if TXTYPE <span class="token operator">==</span>K Blob #then BLOB_GAS_USED <span class="token operator">+</span><span class="token keyword">Int</span> Ctotalblob<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> size<span class="token punctuation">(</span>TVH<span class="token punctuation">)</span><span class="token punctuation">)</span> #else BLOB_GAS_USED #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasPrice</span><span class="token punctuation">&gt;</span></span> GPRICE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasPrice</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ORG <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> ORGBAL <span class="token operator">=&gt;</span> ORGBAL <span class="token operator">+</span><span class="token keyword">Int</span> minInt<span class="token punctuation">(</span>GAVAIL<span class="token punctuation">,</span> GLIMIT <span class="token operator">-</span><span class="token keyword">Int</span> GFLOOR<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token keyword">Int</span> GPRICE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> MINBAL <span class="token operator">=&gt;</span> MINBAL <span class="token operator">+</span><span class="token keyword">Int</span> maxInt<span class="token punctuation">(</span>GLIMIT <span class="token operator">-</span><span class="token keyword">Int</span> GAVAIL<span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>GPRICE <span class="token operator">-</span><span class="token keyword">Int</span> BFEE<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>MSGID<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span> MSGID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txGasLimit</span><span class="token punctuation">&gt;</span></span> GLIMIT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txGasLimit</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span> TVH <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txType</span><span class="token punctuation">&gt;</span></span> TXTYPE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txType</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ORG <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> MINER

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>baseFee</span><span class="token punctuation">&gt;</span></span> BFEE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>baseFee</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origin</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origin</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasUsed</span><span class="token punctuation">&gt;</span></span> GUSED <span class="token operator">=&gt;</span> GUSED <span class="token operator">+</span>Gas maxInt<span class="token punctuation">(</span>GLIMIT <span class="token operator">-</span><span class="token keyword">Int</span> GAVAIL<span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span> BLOB_GAS_USED <span class="token operator">=&gt;</span> #if TXTYPE <span class="token operator">==</span>K Blob #then BLOB_GAS_USED <span class="token operator">+</span><span class="token keyword">Int</span> Ctotalblob<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> size<span class="token punctuation">(</span>TVH<span class="token punctuation">)</span><span class="token punctuation">)</span> #else BLOB_GAS_USED #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasPrice</span><span class="token punctuation">&gt;</span></span> GPRICE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasPrice</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token operator">=&gt;</span> BAL <span class="token operator">+</span><span class="token keyword">Int</span> GLIMIT <span class="token operator">*</span><span class="token keyword">Int</span> GPRICE <span class="token operator">-</span><span class="token keyword">Int</span> maxInt<span class="token punctuation">(</span>GLIMIT <span class="token operator">-</span><span class="token keyword">Int</span> GAVAIL<span class="token punctuation">,</span> GFLOOR<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token keyword">Int</span> BFEE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>MSGID<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span> MSGID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txGasLimit</span><span class="token punctuation">&gt;</span></span> GLIMIT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txGasLimit</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span> TVH <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txType</span><span class="token punctuation">&gt;</span></span> TXTYPE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txType</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> ListItem<span class="token punctuation">(</span>MSGID<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span> REST <span class="token operator">=&gt;</span> REST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span> MSGID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #deleteAccounts<span class="token punctuation">(</span>Set2List<span class="token punctuation">(</span>ACCTS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #finalizeTx<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span>_<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> size<span class="token punctuation">(</span>ACCTS<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #newAccount MINER<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #finalizeTx<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #deleteAccounts<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> ACCTS<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #deleteAccounts<span class="token punctuation">(</span>ACCTS<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">(</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
               <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
          <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bag
           <span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #deleteAccounts<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="fetching-requests-from-event-logs">Fetching requests from event logs</h3>
<p>While processing a block, multiple deposit requests objects with will be produced by the system.
<code>#parseDepositRequest</code> function parses each log item produced in the block and fetches deposit requests.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#filterLogs"</span> <span class="token keyword">Int</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#filterLogs<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #filterLogs IDX <span class="token operator">=&gt;</span> #parseDepositRequest <span class="token punctuation">{</span>LOGS<span class="token punctuation">[</span>IDX<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;SubstateLogEntry <span class="token operator">~&gt;</span> #filterLogs IDX <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> SC <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span><span class="token punctuation">&gt;</span></span> LOGS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> IDX <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">size(LOGS)</span> <span class="token attr-name">andBool</span> <span class="token attr-name">Ghasrequests</span> <span class="token attr-name">&lt;&lt;</span> <span class="token attr-name">SCHED</span> <span class="token punctuation">&gt;</span></span>&gt;
       andBool notBool SC <span class="token operator">==</span>K EVMC_INVALID_BLOCK

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #filterLogs _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #filterLogs _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Rules for parsing Deposit Requests according to EIP-6110.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#parseDepositRequest"</span> SubstateLogEntry <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#parseDepositRequest<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #parseDepositRequest <span class="token punctuation">{</span> ADDR <span class="token operator">|</span> TOPICS <span class="token operator">|</span> DATA <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>depositRequests</span><span class="token punctuation">&gt;</span></span> DEPOSIT_REQUESTS <span class="token operator">=&gt;</span> DEPOSIT_REQUESTS <span class="token operator">+</span>Bytes #extractDepositData<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>depositRequests</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ADDR <span class="token operator">==</span>K DEPOSIT_CONTRACT_ADDRESS
       andBool size<span class="token punctuation">(</span>TOPICS<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>
       andBool <span class="token punctuation">{</span>TOPICS<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;<span class="token keyword">Int</span> <span class="token operator">==</span><span class="token keyword">Int</span> DEPOSIT_EVENT_SIGNATURE_HASH
       andBool #isValidDepositEventData<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #parseDepositRequest <span class="token punctuation">{</span> ADDR <span class="token operator">|</span> TOPICS <span class="token operator">|</span> DATA <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> #end EVMC_INVALID_BLOCK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ADDR <span class="token operator">==</span>K DEPOSIT_CONTRACT_ADDRESS
       andBool size<span class="token punctuation">(</span>TOPICS<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>
       andBool <span class="token punctuation">{</span>TOPICS<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;<span class="token keyword">Int</span> <span class="token operator">==</span><span class="token keyword">Int</span> DEPOSIT_EVENT_SIGNATURE_HASH
       andBool notBool #isValidDepositEventData<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #parseDepositRequest _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<p>Retrieving requests from the output of a system call.
<code>#getRequests WITHDRAWAL_REQUEST_PREDEPLOY_ADDRESS</code> fetches the output of a system call and stores the output in the <code>&lt;withdrawalRequests&gt;</code> cell.
<code>#getRequests CONSOLIDATION_REQUEST_PREDEPLOY_ADDRESS</code> fetches the output of a system call and stores the output in the <code>&lt;consolidationRequests&gt;</code> cell.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#getRequests"</span> <span class="token keyword">Int</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#getRequests<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #getRequests WITHDRAWAL_REQUEST_PREDEPLOY_ADDRESS <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #dropWorldState <span class="token operator">~&gt;</span> #finalizeStorage<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>WITHDRAWAL_REQUEST_PREDEPLOY_ADDRESS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> WRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> WRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #getRequests CONSOLIDATION_REQUEST_PREDEPLOY_ADDRESS <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #dropWorldState <span class="token operator">~&gt;</span> #finalizeStorage<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>CONSOLIDATION_REQUEST_PREDEPLOY_ADDRESS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> CRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> CRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#checkRequestsRoot"</span> <span class="token keyword">Int</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#checkRequestsRoot<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> <span class="token string">"#validateRequestsRoot"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#validateRequestsRoot<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #validateRequestsRoot <span class="token operator">=&gt;</span> #checkRequestsRoot #computeRequestsHash<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>DEPOSIT_REQUEST_TYPE <span class="token operator">+</span>Bytes DRQSTS<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>WITHDRAWAL_REQUEST_TYPE <span class="token operator">+</span>Bytes WRQSTS<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>CONSOLIDATION_REQUEST_TYPE <span class="token operator">+</span>Bytes CRQSTS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>depositRequests</span><span class="token punctuation">&gt;</span></span> DRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>depositRequests</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span> WRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>withdrawalRequests</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span> CRQSTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>consolidationRequests</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkRequestsRoot REQUESTS_ROOT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requestsRoot</span><span class="token punctuation">&gt;</span></span> HEADER_REQUESTS_ROOT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requestsRoot</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> REQUESTS_ROOT <span class="token operator">==</span>K HEADER_REQUESTS_ROOT
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkRequestsRoot REQUESTS_ROOT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requestsRoot</span><span class="token punctuation">&gt;</span></span> HEADER_REQUESTS_ROOT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requestsRoot</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> EVMC_INVALID_BLOCK <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool REQUESTS_ROOT <span class="token operator">==</span>K HEADER_REQUESTS_ROOT

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#processGeneralPurposeRequests"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#processGeneralPurposeRequests<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #processGeneralPurposeRequests
          <span class="token operator">=&gt;</span> #filterLogs <span class="token number">0</span>
          <span class="token operator">~&gt;</span> #systemCall WITHDRAWAL_REQUEST_PREDEPLOY_ADDRESS <span class="token punctuation">.</span>Bytes <span class="token operator">~&gt;</span> #getRequests WITHDRAWAL_REQUEST_PREDEPLOY_ADDRESS
          <span class="token operator">~&gt;</span> #systemCall CONSOLIDATION_REQUEST_PREDEPLOY_ADDRESS <span class="token punctuation">.</span>Bytes <span class="token operator">~&gt;</span> #getRequests CONSOLIDATION_REQUEST_PREDEPLOY_ADDRESS
          <span class="token operator">~&gt;</span> #validateRequestsRoot
          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> SC <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasrequests &lt;&lt; SCHED &gt;&gt;
       andBool SC in <span class="token punctuation">(</span>SetItem<span class="token punctuation">(</span>EVMC_SUCCESS<span class="token punctuation">)</span> SetItem<span class="token punctuation">(</span>EVMC_REVERT<span class="token punctuation">)</span> SetItem<span class="token punctuation">(</span><span class="token punctuation">.</span>StatusCode<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #processGeneralPurposeRequests <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h3 id="blobs">Blobs</h3>
<ul>
<li><code>#validateBlockBlobs COUNT TXIDS</code>: Iterates through the transactions of the current block in order, counting up total versioned hashes (blob commitments) in the block.
Fails block validation by setting EVMC_INVALID_BLOCK if either:</li>
</ul>
<ol>
<li>Total blob count exceeds maximum allowed (<code>Gmaxblobgas</code>)</li>
<li>Calculated block excess blob gas doesn't match the expected value.
Terminates validation successfully when all conditions are met or when blob validation doesn't apply.</li>
</ol>
<ul>
<li><code>#checkTxVersionedHashes</code>: Validates versioned hashes recursively by checking if each hash starts with version byte <code>1</code>.</li>
<li><code>#finalizeBlockBlobs</code>:Updates state at block finalization by:</li>
</ul>
<ol>
<li>Storing current excess blob gas and blob gas used for next block.</li>
<li>Check if blob gas used is within limits.</li>
</ol>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#validateBlockBlobs"</span> <span class="token keyword">Int</span> List <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#validateBlockBlobs<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------</span>
     <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #validateBlockBlobs COUNT <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>IDX<span class="token punctuation">)</span> TXIDS<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #validateBlockBlobs <span class="token punctuation">(</span>COUNT <span class="token operator">+</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>TVH<span class="token punctuation">)</span><span class="token punctuation">)</span> TXIDS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgID</span><span class="token punctuation">&gt;</span></span> IDX <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span> TVH <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txVersionedHashes</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasblobbasefee &lt;&lt; SCHED &gt;&gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #validateBlockBlobs COUNT <span class="token punctuation">.</span>List <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> EVMC_INVALID_BLOCK <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txPending</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txPending</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span> EXCESS_BLOB_GAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span> PREV_EXCESS_BLOB_GAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span> PREV_BLOB_GAS_USED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasblobbasefee &lt;&lt; SCHED &gt;&gt;
        andBool <span class="token punctuation">(</span> Ctotalblob<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> COUNT<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> Gmaxblobgas &lt; SCHED &gt;
            orBool notBool EXCESS_BLOB_GAS <span class="token operator">==</span><span class="token keyword">Int</span> Cexcessblob<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> PREV_EXCESS_BLOB_GAS<span class="token punctuation">,</span> PREV_BLOB_GAS_USED<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #validateBlockBlobs _COUNT _TXIDS <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#finalizeBlockBlobs"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#finalizeBlockBlobs<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeBlockBlobs <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span> BLOB_GAS_USED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span> EXCESS_BLOB_GAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> EXCESS_BLOB_GAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousExcessBlobGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> BLOB_GAS_USED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousBlobGasUsed</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> <span class="token punctuation">(</span> Ghasblobbasefee &lt;&lt; SCHED &gt;&gt; andBool BLOB_GAS_USED <span class="token operator">&lt;=</span><span class="token keyword">Int</span> Gmaxblobgas &lt; SCHED &gt; <span class="token punctuation">)</span>
        orBool notBool Ghasblobbasefee &lt;&lt; SCHED &gt;&gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeBlockBlobs <span class="token operator">=&gt;</span> #end EVMC_INVALID_BLOCK <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #checkTxVersionedHashes <span class="token punctuation">(</span>List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> <span class="token class-name">symbol</span><span class="token punctuation">(</span>#checkTxVersionedHashes<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #checkTxVersionedHashes <span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #checkTxVersionedHashes <span class="token punctuation">(</span> ListItem<span class="token punctuation">(</span>VH<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> TVH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #checkTxVersionedHashes<span class="token punctuation">(</span>TVH<span class="token punctuation">)</span> <span class="token keyword">requires</span>         VH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">1</span>
    <span class="token keyword">rule</span> #checkTxVersionedHashes <span class="token punctuation">(</span> ListItem<span class="token punctuation">(</span>VH<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> _  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span>                        <span class="token keyword">requires</span> notBool VH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">1</span>
</code></pre>
<h3 id="block-processing">Block processing</h3>
<ul>
<li><code>#startBlock</code> is used to signal that we are about to start mining a block and block initialization should take place (before transactions are executed).</li>
<li><code>#finalizeBlock</code> is used to signal that block finalization procedures should take place (after transactions have executed).</li>
<li><code>#rewardOmmers(_)</code> pays out the reward to uncle blocks so that blocks are orphaned less often in Ethereum.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> EthereumCommand <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#startBlock"</span>
 <span class="token comment">// ----------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #startBlock <span class="token operator">=&gt;</span> #validateBlockBlobs <span class="token number">0</span> TXS <span class="token operator">~&gt;</span> #executeBeaconRoots <span class="token operator">~&gt;</span> #executeBlockHashHistory <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasUsed</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blobGasUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logsBloom</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logsBloom</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>txOrder</span><span class="token punctuation">&gt;</span></span> TXS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>txOrder</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> EthereumCommand <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#finalizeBlock"</span>
                             <span class="token operator">|</span> #rewardOmmers <span class="token punctuation">(</span> JSONs <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#rewardOmmers<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finalizeBlock
          <span class="token operator">=&gt;</span> #if Ghaswithdrawals &lt;&lt; SCHED &gt;&gt; #then #finalizeWithdrawals #else <span class="token punctuation">.</span>K #fi
          <span class="token operator">~&gt;</span> #rewardOmmers<span class="token punctuation">(</span>OMMERS<span class="token punctuation">)</span>
          <span class="token operator">~&gt;</span> #processGeneralPurposeRequests
          <span class="token operator">~&gt;</span> #finalizeBlockBlobs
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ommerBlockHeaders</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span> OMMERS <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ommerBlockHeaders</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> MINBAL <span class="token operator">=&gt;</span> MINBAL <span class="token operator">+</span><span class="token keyword">Int</span> Rb &lt; SCHED &gt; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span><span class="token punctuation">&gt;</span></span> LOGS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logsBloom</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #bloomFilter<span class="token punctuation">(</span>LOGS<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logsBloom</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #newAccount MINER<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #finalizeBlock <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #rewardOmmers<span class="token punctuation">(</span><span class="token punctuation">.</span>JSONs<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #rewardOmmers<span class="token punctuation">(</span><span class="token punctuation">[</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> OMMER <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">,</span> OMMNUM <span class="token punctuation">,</span> _ <span class="token punctuation">]</span> <span class="token punctuation">,</span> REST<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #rewardOmmers<span class="token punctuation">(</span>REST<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span> CURNUM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> MINER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> MINBAL <span class="token operator">=&gt;</span> MINBAL <span class="token operator">+</span><span class="token keyword">Int</span> Rb &lt; SCHED &gt; <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> OMMER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> OMMBAL <span class="token operator">=&gt;</span> OMMBAL <span class="token operator">+</span><span class="token keyword">Int</span> Rb &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>OMMNUM <span class="token operator">-</span><span class="token keyword">Int</span> CURNUM<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Rb &lt; SCHED &gt; <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #bloomFilter<span class="token punctuation">(</span>List<span class="token punctuation">)</span>      <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#bloomFilter<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
                   <span class="token operator">|</span> #bloomFilter<span class="token punctuation">(</span>List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#bloomFilterAux<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #bloomFilter<span class="token punctuation">(</span>L<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #bloomFilter<span class="token punctuation">(</span>L<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #bloomFilter<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #bloomFilter<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span><span class="token punctuation">{</span> ACCT <span class="token operator">|</span> TOPICS <span class="token operator">|</span> _ <span class="token punctuation">}</span><span class="token punctuation">)</span> L<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #bloomFilter<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>#padToWidth<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> listAsBytes<span class="token punctuation">(</span>TOPICS<span class="token punctuation">)</span> L<span class="token punctuation">,</span> B<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> List <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> listAsBytes<span class="token punctuation">(</span>List<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>listAsBytes<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------</span>
    <span class="token keyword">rule</span> listAsBytes<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>List
    <span class="token keyword">rule</span> listAsBytes<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>TOPIC<span class="token punctuation">)</span> L<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span>#padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>TOPIC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> listAsBytes<span class="token punctuation">(</span>L<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #bloomFilter<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>WS<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> L<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #bloomFilter<span class="token punctuation">(</span>L<span class="token punctuation">,</span> B <span class="token operator">|</span><span class="token keyword">Int</span> M3<span class="token punctuation">:</span><span class="token number">2048</span><span class="token punctuation">(</span>WS<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<ul>
<li><code>M3:2048</code> computes the 2048-bit hash of a log entry in which exactly 3 bits are set. This is used to compute the Bloom filter of a log entry.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"M3:2048"</span> <span class="token string">"("</span> Bytes <span class="token string">")"</span> <span class="token punctuation">[</span>function<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------</span>
    <span class="token keyword">rule</span> M3<span class="token punctuation">:</span><span class="token number">2048</span><span class="token punctuation">(</span>WS<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> setBloomFilterBits<span class="token punctuation">(</span>#parseByteStack<span class="token punctuation">(</span>Keccak256<span class="token punctuation">(</span>WS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> setBloomFilterBits<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>setBloomFilterBits<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> setBloomFilterBits<span class="token punctuation">(</span>HASH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> getBloomFilterBit<span class="token punctuation">(</span>HASH<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> getBloomFilterBit<span class="token punctuation">(</span>HASH<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> getBloomFilterBit<span class="token punctuation">(</span>HASH<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> getBloomFilterBit<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>getBloomFilterBit<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> getBloomFilterBit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> I<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #asInteger<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>X<span class="token punctuation">,</span> I<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token keyword">Int</span> <span class="token number">2048</span>
</code></pre>
<p>If <code>block.timestamp &gt;= CANCUN_FORK_TIMESTAMP</code>:
Before executing any transaction, the <code>BEACON_ROOTS_ADDRESS</code> (<code>0x000F3df6D732807Ef1319fB7B8bB8522d0Beac02</code>) storage is modified as following:</p>
<ul>
<li>Set the storage value at <code>header.timestamp % HISTORY_BUFFER_LENGTH</code> to be <code>header.timestamp</code></li>
<li>Set the storage value at <code>header.timestamp % HISTORY_BUFFER_LENGTH + HISTORY_BUFFER_LENGTH</code> to be <code>header.parent_beacon_root_hash</code>
where <code>HISTORY_BUFFER_LENGTH == 8191</code>.</li>
</ul>
<p>Read more about EIP-4788 here <a href="https://eips.ethereum.org/EIPS/eip-4788" target="_blank" rel="noreferrer noopener">https://eips.ethereum.org/EIPS/eip-4788</a>.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#executeBeaconRoots"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#executeBeaconRoots<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #executeBeaconRoots <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timestamp</span><span class="token punctuation">&gt;</span></span> TS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timestamp</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beaconRoot</span><span class="token punctuation">&gt;</span></span> BR <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beaconRoot</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> BEACON_ROOTS_ADDRESS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> M<span class="token punctuation">:</span>Map <span class="token operator">=&gt;</span> M <span class="token punctuation">[</span><span class="token punctuation">(</span>TS modInt <span class="token number">8191</span><span class="token punctuation">)</span> &lt;<span class="token operator">-</span> TS<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>TS modInt <span class="token number">8191</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">8191</span><span class="token punctuation">)</span> &lt;<span class="token operator">-</span> BR<span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasbeaconroot &lt;&lt; SCHED &gt;&gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #executeBeaconRoots <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<p>If <code>block.timestamp &gt;= PRAGUE_FORK_TIMESTAMP</code>:
Before executing any transaction, the <code>HISTORY_STORAGE_ADDRESS</code> (<code>0x0000F90827F1C53a10cb7A02335B175320002935</code>) storage is modified as following:</p>
<ul>
<li>Set the storage value at <code>(block.number-1) % HISTORY_SERVE_WINDOW</code> to be <code> block.parent.hash</code>
where <code>HISTORY_SERVE_WINDOW == 8191</code>.</li>
</ul>
<p>Read more about EIP-2935 here <a href="https://eips.ethereum.org/EIPS/eip-2935" target="_blank" rel="noreferrer noopener">https://eips.ethereum.org/EIPS/eip-2935</a>.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#executeBlockHashHistory"</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#executeBlockHashHistory<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #executeBlockHashHistory <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>previousHash</span><span class="token punctuation">&gt;</span></span> HP <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>previousHash</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span> BN <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> HISTORY_STORAGE_ADDRESS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> M<span class="token punctuation">:</span>Map <span class="token operator">=&gt;</span> M <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BN <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span> modInt <span class="token number">8191</span><span class="token punctuation">)</span> &lt;<span class="token operator">-</span> HP<span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghashistory &lt;&lt; SCHED &gt;&gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #executeBlockHashHistory <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h1 id="evm-programs">EVM Programs</h1>
<h2 id="evm-opcodes">EVM OpCodes</h2>
<h3 id="internal-operations">Internal Operations</h3>
<p>These are just used by the other operators for shuffling local execution state around on the EVM.</p>
<ul>
<li><code>#push</code> will push an element to the <code>wordStack</code> without any checks.</li>
<li><code>#setStack_</code> will set the current stack to the given one.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#push"</span> <span class="token operator">|</span> <span class="token string">"#setStack"</span> WordStack
 <span class="token comment">// -----------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> W0<span class="token punctuation">:</span><span class="token keyword">Int</span> <span class="token operator">~&gt;</span> #push <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token operator">=&gt;</span> W0 <span class="token punctuation">:</span> WS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #setStack WS    <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> _  <span class="token operator">=&gt;</span> WS      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><code>#newAccount_</code> allows declaring a new empty account with the given address (and assumes the rounding to 160 bits has already occurred).
If the account already exists with non-zero nonce or non-empty code, an exception is thrown.
Otherwise, if the account already exists, the storage is cleared.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#newAccount"</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#newExistingAccount"</span> <span class="token keyword">Int</span>
 <span class="token comment">// -----------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #newAccount ACCT <span class="token operator">=&gt;</span> #newExistingAccount ACCT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #newAccount ACCT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">&gt;</span></span>
               <span class="token punctuation">(</span> <span class="token punctuation">.</span>Bag
                  <span class="token operator">=&gt;</span>
                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span>           <span class="token number">0</span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>              <span class="token punctuation">.</span>Bytes<span class="token punctuation">:</span>AccountCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span>           <span class="token punctuation">.</span>Map               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origStorage</span><span class="token punctuation">&gt;</span></span>       <span class="token punctuation">.</span>Map               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origStorage</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span>             <span class="token number">0</span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transientStorage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span>Map          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transientStorage</span><span class="token punctuation">&gt;</span></span>
                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
               <span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #newExistingAccount ACCT <span class="token operator">=&gt;</span> #end EVMC_ACCOUNT_ALREADY_EXISTS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>   CODE  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span>  NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> STORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> CODE <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K <span class="token punctuation">.</span>Bytes orBool NONCE <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span> orBool STORAGE <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K <span class="token punctuation">.</span>Map

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #newExistingAccount ACCT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span>      ACCT      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>        CODE      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span>       <span class="token number">0</span>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span>     <span class="token punctuation">.</span>Map   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origStorage</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Map <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
</code></pre>
<ul>
<li><code>#transferFunds</code> moves money from one account into another, creating the destination account if it doesn't exist.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#transferFunds"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#transferFundsToNonExistent"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
 <span class="token comment">// ---------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFunds ACCT ACCT VALUE <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> ORIGFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> VALUE <span class="token operator">&lt;=</span><span class="token keyword">Int</span> ORIGFROM

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFunds ACCTFROM ACCTTO VALUE <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> ORIGFROM <span class="token operator">=&gt;</span> ORIGFROM <span class="token operator">-</span>Word VALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> ORIGTO <span class="token operator">=&gt;</span> ORIGTO <span class="token operator">+</span>Word VALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ACCTFROM <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K ACCTTO andBool VALUE <span class="token operator">&lt;=</span><span class="token keyword">Int</span> ORIGFROM
      <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFunds ACCTFROM _ACCTTO VALUE <span class="token operator">=&gt;</span> #end EVMC_BALANCE_UNDERFLOW <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> ORIGFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> VALUE &gt;<span class="token keyword">Int</span> ORIGFROM

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFunds ACCTFROM ACCTTO VALUE <span class="token operator">=&gt;</span> #transferFundsToNonExistent ACCTFROM ACCTTO VALUE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFundsToNonExistent ACCTFROM ACCTTO VALUE <span class="token operator">=&gt;</span> #newAccount ACCTTO <span class="token operator">~&gt;</span> #transferFunds ACCTFROM ACCTTO VALUE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ACCTFROM <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K ACCTTO
       andBool <span class="token punctuation">(</span>VALUE &gt;<span class="token keyword">Int</span> <span class="token number">0</span> orBool notBool Gemptyisnonexistent &lt;&lt; SCHED &gt;&gt;<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #transferFundsToNonExistent ACCTFROM ACCTTO <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> ACCTFROM <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K ACCTTO
       andBool Gemptyisnonexistent &lt;&lt; SCHED &gt;&gt;
</code></pre>
<h3 id="invalid-operator">Invalid Operator</h3>
<p>We use <code>INVALID</code> both for marking the designated invalid operator, and <code>UNDEFINED(_)</code> for garbage bytes in the input program.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InvalidOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"INVALID"</span> <span class="token operator">|</span> <span class="token string">"UNDEFINED"</span> <span class="token string">"("</span> <span class="token keyword">Int</span> <span class="token string">")"</span>
 <span class="token comment">// --------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> INVALID      <span class="token operator">=&gt;</span> #end EVMC_INVALID_INSTRUCTION   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> UNDEFINED<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_UNDEFINED_INSTRUCTION <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="stack-manipulations">Stack Manipulations</h3>
<p>Some operators don't calculate anything, they just push the stack around a bit.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"POP"</span>
 <span class="token comment">// --------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> POP _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> StackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> DUP  <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>DUP<span class="token punctuation">)</span><span class="token punctuation">]</span>
                     <span class="token operator">|</span> SWAP <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>SWAP<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> DUP<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  WS<span class="token punctuation">:</span>WordStack <span class="token operator">=&gt;</span> #setStack <span class="token punctuation">(</span><span class="token punctuation">(</span>WS <span class="token punctuation">[</span> N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> WS<span class="token punctuation">)</span>                      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SWAP<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token punctuation">(</span>W0 <span class="token punctuation">:</span> WS<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> #setStack <span class="token punctuation">(</span><span class="token punctuation">(</span>WS <span class="token punctuation">[</span> N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>WS <span class="token punctuation">[</span> N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token punctuation">:</span><span class="token operator">=</span> W0 <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> PushOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"PUSHZERO"</span>
                    <span class="token operator">|</span> PUSH <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>PUSH<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> PUSHZERO <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> PUSH<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> PCOUNT <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span> PCOUNT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span> PGM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="local-memory">Local Memory</h3>
<p>These operations are getters/setters of the local execution memory.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"MLOAD"</span>
 <span class="token comment">// ----------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MLOAD INDEX <span class="token operator">=&gt;</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"MSTORE"</span> <span class="token operator">|</span> <span class="token string">"MSTORE8"</span>
 <span class="token comment">// ------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MSTORE INDEX VALUE <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> INDEX <span class="token punctuation">:</span><span class="token operator">=</span> #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>VALUE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MSTORE8 INDEX VALUE <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> #write<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> <span class="token punctuation">(</span>VALUE modInt <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"MCOPY"</span>
 <span class="token comment">// ------------------------------</span>
     <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MCOPY DST SRC LEN <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> DST <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> SRC<span class="token punctuation">,</span> LEN<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="expressions">Expressions</h3>
<p>Expression calculations are simple and don't require anything but the arguments from the <code>wordStack</code> to operate.</p>
<p>NOTE: We have to call the opcode <code>OR</code> by <code>EVMOR</code> instead, because K has trouble parsing it/compiling the definition otherwise.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ISZERO"</span> <span class="token operator">|</span> <span class="token string">"NOT"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ISZERO W <span class="token operator">=&gt;</span> W <span class="token operator">==</span>Word <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> NOT    W <span class="token operator">=&gt;</span> <span class="token operator">~</span>Word W    <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ADD"</span> <span class="token operator">|</span> <span class="token string">"MUL"</span> <span class="token operator">|</span> <span class="token string">"SUB"</span> <span class="token operator">|</span> <span class="token string">"DIV"</span> <span class="token operator">|</span> <span class="token string">"EXP"</span> <span class="token operator">|</span> <span class="token string">"MOD"</span>
 <span class="token comment">// -------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ADD W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">+</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MUL W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">*</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SUB W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">-</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> DIV W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">/</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXP W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">^</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MOD W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">%</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SDIV"</span> <span class="token operator">|</span> <span class="token string">"SMOD"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SDIV W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">/</span>sWord W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SMOD W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">%</span>sWord W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ADDMOD"</span> <span class="token operator">|</span> <span class="token string">"MULMOD"</span>
 <span class="token comment">// ------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ADDMOD W0 W1 W2 <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>W0 <span class="token operator">+</span><span class="token keyword">Int</span> W1<span class="token punctuation">)</span> <span class="token operator">%</span>Word W2 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MULMOD W0 W1 W2 <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>W0 <span class="token operator">*</span><span class="token keyword">Int</span> W1<span class="token punctuation">)</span> <span class="token operator">%</span>Word W2 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BYTE"</span> <span class="token operator">|</span> <span class="token string">"SIGNEXTEND"</span>
 <span class="token comment">// -------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BYTE INDEX W     <span class="token operator">=&gt;</span> byte<span class="token punctuation">(</span>INDEX<span class="token punctuation">,</span> W<span class="token punctuation">)</span>     <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SIGNEXTEND W0 W1 <span class="token operator">=&gt;</span> signextend<span class="token punctuation">(</span>W0<span class="token punctuation">,</span> W1<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SHL"</span> <span class="token operator">|</span> <span class="token string">"SHR"</span> <span class="token operator">|</span> <span class="token string">"SAR"</span>
 <span class="token comment">// -------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SHL W0 W1 <span class="token operator">=&gt;</span> W1 &lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Word</span>  <span class="token attr-name">W0</span> <span class="token attr-name">~</span><span class="token punctuation">&gt;</span></span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SHR W0 W1 <span class="token operator">=&gt;</span> W1 &gt;&gt;Word  W0 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SAR W0 W1 <span class="token operator">=&gt;</span> W1 &gt;&gt;sWord W0 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"AND"</span> <span class="token operator">|</span> <span class="token string">"EVMOR"</span> <span class="token operator">|</span> <span class="token string">"XOR"</span>
 <span class="token comment">// ---------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> AND   W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">&amp;</span>Word W1   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EVMOR W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">|</span>Word W1   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> XOR   W0 W1 <span class="token operator">=&gt;</span> W0 xorWord W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"LT"</span> <span class="token operator">|</span> <span class="token string">"GT"</span> <span class="token operator">|</span> <span class="token string">"EQ"</span>
 <span class="token comment">// ----------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> LT W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Word</span>  <span class="token attr-name">W1</span> <span class="token attr-name">~</span><span class="token punctuation">&gt;</span></span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> GT W0 W1 <span class="token operator">=&gt;</span> W0 &gt;Word  W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EQ W0 W1 <span class="token operator">=&gt;</span> W0 <span class="token operator">==</span>Word W1 <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SLT"</span> <span class="token operator">|</span> <span class="token string">"SGT"</span>
 <span class="token comment">// -----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SLT W0 W1 <span class="token operator">=&gt;</span> W0 s<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Word</span> <span class="token attr-name">W1</span> <span class="token attr-name">~</span><span class="token punctuation">&gt;</span></span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SGT W0 W1 <span class="token operator">=&gt;</span> W1 s<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Word</span> <span class="token attr-name">W0</span> <span class="token attr-name">~</span><span class="token punctuation">&gt;</span></span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SHA3"</span>
 <span class="token comment">// ----------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SHA3 MEMSTART MEMWIDTH <span class="token operator">=&gt;</span> keccak<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="local-state">Local State</h3>
<p>These operators make queries about the current execution state.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"PC"</span> <span class="token operator">|</span> <span class="token string">"GAS"</span> <span class="token operator">|</span> <span class="token string">"GASPRICE"</span> <span class="token operator">|</span> <span class="token string">"GASLIMIT"</span> <span class="token operator">|</span> <span class="token string">"BASEFEE"</span> <span class="token operator">|</span> <span class="token string">"BLOBBASEFEE"</span>
 <span class="token comment">// -----------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> PC          <span class="token operator">=&gt;</span> PCOUNT                      <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span> PCOUNT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> GAS         <span class="token operator">=&gt;</span> gas2Int<span class="token punctuation">(</span>GAVAIL<span class="token punctuation">)</span>             <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> GASPRICE    <span class="token operator">=&gt;</span> GPRICE                      <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasPrice</span><span class="token punctuation">&gt;</span></span> GPRICE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasPrice</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> GASLIMIT    <span class="token operator">=&gt;</span> GLIMIT                      <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gasLimit</span><span class="token punctuation">&gt;</span></span> GLIMIT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gasLimit</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BASEFEE     <span class="token operator">=&gt;</span> BFEE                        <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>baseFee</span><span class="token punctuation">&gt;</span></span> BFEE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>baseFee</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLOBBASEFEE <span class="token operator">=&gt;</span> Cbasefeeperblob<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXCESS_BLOB_GAS<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span> EXCESS_BLOB_GAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excessBlobGas</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>  <span class="token keyword">requires</span> notBool #rangeNegUInt64<span class="token punctuation">(</span>EXCESS_BLOB_GAS<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"COINBASE"</span> <span class="token operator">|</span> <span class="token string">"TIMESTAMP"</span> <span class="token operator">|</span> <span class="token string">"NUMBER"</span> <span class="token operator">|</span> <span class="token string">"DIFFICULTY"</span> <span class="token operator">|</span> <span class="token string">"PREVRANDAO"</span>
 <span class="token comment">// ----------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> COINBASE   <span class="token operator">=&gt;</span> CB   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coinbase</span><span class="token punctuation">&gt;</span></span> CB <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coinbase</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> TIMESTAMP  <span class="token operator">=&gt;</span> TS   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timestamp</span><span class="token punctuation">&gt;</span></span> TS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timestamp</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> NUMBER     <span class="token operator">=&gt;</span> NUMB <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span> NUMB <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> DIFFICULTY <span class="token operator">=&gt;</span> DIFF <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>difficulty</span><span class="token punctuation">&gt;</span></span> DIFF <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>difficulty</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> PREVRANDAO <span class="token operator">=&gt;</span> RDAO <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mixHash</span><span class="token punctuation">&gt;</span></span> RDAO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mixHash</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ADDRESS"</span> <span class="token operator">|</span> <span class="token string">"ORIGIN"</span> <span class="token operator">|</span> <span class="token string">"CALLER"</span> <span class="token operator">|</span> <span class="token string">"CALLVALUE"</span> <span class="token operator">|</span> <span class="token string">"CHAINID"</span> <span class="token operator">|</span> <span class="token string">"SELFBALANCE"</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ADDRESS     <span class="token operator">=&gt;</span> ACCT <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ORIGIN      <span class="token operator">=&gt;</span> ORG  <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origin</span><span class="token punctuation">&gt;</span></span> ORG <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origin</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLER      <span class="token operator">=&gt;</span> CL   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span> CL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLVALUE   <span class="token operator">=&gt;</span> CV   <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> CV <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CHAINID     <span class="token operator">=&gt;</span> CID  <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>chainID</span><span class="token punctuation">&gt;</span></span> CID <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>chainID</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SELFBALANCE <span class="token operator">=&gt;</span> BAL  <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"MSIZE"</span> <span class="token operator">|</span> <span class="token string">"CODESIZE"</span>
 <span class="token comment">// -------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MSIZE    <span class="token operator">=&gt;</span> <span class="token number">32</span> <span class="token operator">*</span>Word MU         <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memoryUsed</span><span class="token punctuation">&gt;</span></span> MU <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CODESIZE <span class="token operator">=&gt;</span> lengthBytes<span class="token punctuation">(</span>PGM<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span> PGM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CODECOPY"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CODECOPY MEMSTART PGMSTART WIDTH <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span> PGM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span>  LM <span class="token punctuation">[</span> MEMSTART <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> PGMSTART<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLOCKHASH"</span>
 <span class="token comment">// --------------------------------</span>
</code></pre>
<p>The blockhash is calculated here using the "shortcut" formula used for running tests.</p>
<pre><code class="language-k">    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLOCKHASH N <span class="token operator">=&gt;</span> #blockhash<span class="token punctuation">(</span>HASHES<span class="token punctuation">,</span> N<span class="token punctuation">,</span> HI <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span>      HI     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>blockhashes</span><span class="token punctuation">&gt;</span></span> HASHES <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>blockhashes</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #blockhash <span class="token punctuation">(</span> List <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#blockhash<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #blockhash<span class="token punctuation">(</span>_<span class="token punctuation">,</span> N<span class="token punctuation">,</span> HI<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token keyword">requires</span> N &gt;<span class="token keyword">Int</span> HI
    <span class="token keyword">rule</span> #blockhash<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #blockhash<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #blockhash<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>H<span class="token punctuation">)</span> _<span class="token punctuation">,</span> N<span class="token punctuation">,</span> N<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> H
    <span class="token keyword">rule</span> #blockhash<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>_<span class="token punctuation">)</span> L<span class="token punctuation">,</span> N<span class="token punctuation">,</span> HI<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #blockhash<span class="token punctuation">(</span>L<span class="token punctuation">,</span> N<span class="token punctuation">,</span> HI <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> A <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLOBHASH"</span>
 <span class="token comment">// -------------------------------</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLOBHASH INDEX <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>versionedHashes</span><span class="token punctuation">&gt;</span></span> HASHES <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>versionedHashes</span><span class="token punctuation">&gt;</span></span>
       <span class="token keyword">requires</span> INDEX <span class="token operator">&gt;=</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>HASHES<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLOBHASH INDEX <span class="token operator">=&gt;</span> #asWord<span class="token punctuation">(</span> <span class="token punctuation">{</span>HASHES<span class="token punctuation">[</span>INDEX<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">:</span>&gt;Bytes <span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>versionedHashes</span><span class="token punctuation">&gt;</span></span> HASHES <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>versionedHashes</span><span class="token punctuation">&gt;</span></span>
       <span class="token keyword">requires</span> INDEX &lt;<span class="token keyword">Int</span> size<span class="token punctuation">(</span>HASHES<span class="token punctuation">)</span>
</code></pre>
<h2 id="evm-opcodes-1">EVM OpCodes</h2>
<h3 id="evm-control-flow">EVM Control Flow</h3>
<p>The <code>JUMP*</code> family of operations affect the current program counter.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"JUMPDEST"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> JUMPDEST <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"JUMP"</span>
 <span class="token comment">// ---------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>jump<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> JUMP DEST <span class="token operator">=&gt;</span> #endBasicBlock <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> DEST <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jumpDests</span><span class="token punctuation">&gt;</span></span> DESTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jumpDests</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> DEST &lt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>DESTS<span class="token punctuation">)</span> andBool DESTS<span class="token punctuation">[</span>DEST<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">1</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> JUMP _ <span class="token operator">=&gt;</span> #end EVMC_BAD_JUMP_DESTINATION <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"JUMPI"</span>
 <span class="token comment">// -----------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>jumpi<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> JUMPI _DEST I <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> I  <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>jumpi<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> JUMPI  DEST I <span class="token operator">=&gt;</span> JUMP DEST <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> I <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#endBasicBlock"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #endBasicBlock <span class="token operator">~&gt;</span> <span class="token punctuation">(</span>_<span class="token punctuation">:</span>OpCode <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>end<span class="token operator">-</span>basic<span class="token operator">-</span>block<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>#endBasicBlock <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #execute <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="stop%2C-revert%2C-and-return"><code>STOP</code>, <code>REVERT</code>, and <code>RETURN</code></h3>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"STOP"</span>
 <span class="token comment">// -----------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> STOP <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"RETURN"</span>
 <span class="token comment">// ------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> RETURN RETSTART RETWIDTH <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> RETSTART<span class="token punctuation">,</span> RETWIDTH<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"REVERT"</span>
 <span class="token comment">// ------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> REVERT RETSTART RETWIDTH <span class="token operator">=&gt;</span> #end EVMC_REVERT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> RETSTART<span class="token punctuation">,</span> RETWIDTH<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="call-data">Call Data</h3>
<p>These operators query about the current <code>CALL*</code> state.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CALLDATASIZE"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLDATASIZE <span class="token operator">=&gt;</span> lengthBytes<span class="token punctuation">(</span>CD<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CALLDATALOAD"</span>
 <span class="token comment">// -----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLDATALOAD DATASTART <span class="token operator">=&gt;</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>CD<span class="token punctuation">,</span> DATASTART<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CALLDATACOPY"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLDATACOPY MEMSTART DATASTART DATAWIDTH <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> MEMSTART <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>CD<span class="token punctuation">,</span> DATASTART<span class="token punctuation">,</span> DATAWIDTH<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="return-data">Return Data</h3>
<p>These operators query about the current return data buffer.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"RETURNDATASIZE"</span>
 <span class="token comment">// ---------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> RETURNDATASIZE <span class="token operator">=&gt;</span> lengthBytes<span class="token punctuation">(</span>RD<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> RD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"RETURNDATACOPY"</span>
 <span class="token comment">// ---------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> RETURNDATACOPY MEMSTART DATASTART DATAWIDTH <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> MEMSTART <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>RD<span class="token punctuation">,</span> DATASTART<span class="token punctuation">,</span> DATAWIDTH<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> RD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> DATASTART <span class="token operator">+</span><span class="token keyword">Int</span> DATAWIDTH <span class="token operator">&lt;=</span><span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>RD<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> RETURNDATACOPY _MEMSTART DATASTART DATAWIDTH <span class="token operator">=&gt;</span> #end EVMC_INVALID_MEMORY_ACCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> RD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> DATASTART <span class="token operator">+</span><span class="token keyword">Int</span> DATAWIDTH &gt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>RD<span class="token punctuation">)</span>
</code></pre>
<h3 id="log-operations">Log Operations</h3>
<pre><code class="language-k">    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> LogOp
    <span class="token keyword">syntax</span> LogOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> LOG <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>LOG<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> LOG<span class="token punctuation">(</span>N<span class="token punctuation">)</span> MEMSTART MEMWIDTH <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span> WS <span class="token operator">=&gt;</span> #drop<span class="token punctuation">(</span>N<span class="token punctuation">,</span> WS<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span><span class="token punctuation">&gt;</span></span> L <span class="token operator">=&gt;</span> L ListItem<span class="token punctuation">(</span><span class="token punctuation">{</span> ACCT <span class="token operator">|</span> WordStack2List<span class="token punctuation">(</span>#take<span class="token punctuation">(</span>N<span class="token punctuation">,</span> WS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #sizeWordStack<span class="token punctuation">(</span>WS<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> N
</code></pre>
<h2 id="ethereum-network-opcodes">Ethereum Network OpCodes</h2>
<p>Operators that require access to the rest of the Ethereum network world-state can be taken as a first draft of a "blockchain generic" language.</p>
<h3 id="account-queries">Account Queries</h3>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BALANCE"</span>
 <span class="token comment">// ------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>balance<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BALANCE ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> BAL <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>balance<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BALANCE ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"EXTCODESIZE"</span>
 <span class="token comment">// ----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodesize<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODESIZE ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> lengthBytes<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodesize<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODESIZE ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"EXTCODEHASH"</span>
 <span class="token comment">// ----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodehash<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODEHASH ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> keccak<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE<span class="token punctuation">:</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool #accountEmpty<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span> NONCE<span class="token punctuation">,</span> BAL<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodehash<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODEHASH ACCT <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> QuadStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"EXTCODECOPY"</span>
 <span class="token comment">// ------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodecopy<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODECOPY ACCT MEMSTART PGMSTART WIDTH <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> MEMSTART <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> PGMSTART<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> PGM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>extcodecopy<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> EXTCODECOPY ACCT MEMSTART _ WIDTH <span class="token operator">=&gt;</span> #accessAccounts ACCT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> MEMSTART <span class="token punctuation">:</span><span class="token operator">=</span> #padToWidth<span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span> <span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h3 id="account-storage-operations">Account Storage Operations</h3>
<p>These rules reach into the network state and load/store from account storage:</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SLOAD"</span>
 <span class="token comment">// ----------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>sload<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SLOAD INDEX <span class="token operator">=&gt;</span> #lookup<span class="token punctuation">(</span>STORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> STORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SSTORE"</span>
 <span class="token comment">// ------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>sstore<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SSTORE INDEX NEW <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> STORAGE <span class="token operator">=&gt;</span> STORAGE <span class="token punctuation">[</span> INDEX &lt;<span class="token operator">-</span> NEW <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"TLOAD"</span>
 <span class="token comment">// ----------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>tload<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> TLOAD INDEX <span class="token operator">=&gt;</span> #lookup<span class="token punctuation">(</span>TSTORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transientStorage</span><span class="token punctuation">&gt;</span></span> TSTORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transientStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BinStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"TSTORE"</span>
 <span class="token comment">// ------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>tstore<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> TSTORE INDEX NEW <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transientStorage</span><span class="token punctuation">&gt;</span></span> TSTORAGE <span class="token operator">=&gt;</span> TSTORAGE <span class="token punctuation">[</span> INDEX &lt;<span class="token operator">-</span> NEW <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transientStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
</code></pre>
<h3 id="call-operations">Call Operations</h3>
<p>The various <code>CALL*</code> (and other inter-contract control flow) operations will be desugared into these <code>InternalOp</code>s.</p>
<ul>
<li><code>#checkCall</code> takes the calling account and the value of the call and triggers several checks before executing the call.</li>
<li><code>#checkBalanceUnderflow</code> takes the calling account and the value of the call and checks if the call value is greater than the account balance.</li>
<li><code>#checkDepthExceeded</code> checks if the current call depth is greater than or equal to <code>1024</code>.</li>
<li><code>#checkNonceExceeded</code> takes the calling account and checks if the nonce is less than <code>maxUInt64</code> (<code>18446744073709551615</code>).</li>
<li><code>#call</code> takes the calling account, the account to execute as, the account whose code should execute, the gas limit, the amount to transfer, the arguments, and the static flag.</li>
<li><code>#callWithCode</code> takes the calling account, the account to execute as, the code to execute (as a <code>Bytes</code>), the gas limit, the amount to transfer, the arguments, and the static flag.</li>
<li><code>#return</code> is a placeholder for the calling program, specifying where to place the returned data in memory.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#checkCall"</span>             <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#checkBalanceUnderflow"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#checkNonceExceeded"</span>    <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#checkDepthExceeded"</span>
                        <span class="token operator">|</span> <span class="token string">"#call"</span>                  <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes <span class="token keyword">Bool</span>
                        <span class="token operator">|</span> <span class="token string">"#callWithCode"</span>          <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes <span class="token keyword">Bool</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>callwithcode_check_fork<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> <span class="token string">"#mkCall"</span>                <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes     <span class="token keyword">Int</span> Bytes <span class="token keyword">Bool</span>
 <span class="token comment">// -----------------------------------------------------------------------------------</span>
     <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkBalanceUnderflow ACCT VALUE <span class="token operator">=&gt;</span> #refund GCALL <span class="token operator">~&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState <span class="token operator">~&gt;</span> #end EVMC_BALANCE_UNDERFLOW <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> VALUE &gt;<span class="token keyword">Int</span> BAL

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkBalanceUnderflow ACCT VALUE <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> VALUE <span class="token operator">&lt;=</span><span class="token keyword">Int</span> BAL

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkDepthExceeded <span class="token operator">=&gt;</span> #refund GCALL <span class="token operator">~&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState <span class="token operator">~&gt;</span> #end EVMC_CALL_DEPTH_EXCEEDED <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> CD <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">1024</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkDepthExceeded <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> CD <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">1024</span>

    <span class="token attr-name">rule</span> <span class="token attr-name">&lt;k</span><span class="token punctuation">&gt;</span></span> #checkNonceExceeded ACCT <span class="token operator">=&gt;</span> #refund GCALL <span class="token operator">~&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState <span class="token operator">~&gt;</span> #end EVMC_NONCE_EXCEEDED <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool #rangeNonce<span class="token punctuation">(</span>NONCE<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkNonceExceeded ACCT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #rangeNonce<span class="token punctuation">(</span>NONCE<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkCall ACCT VALUE <span class="token operator">=&gt;</span> #checkBalanceUnderflow ACCT VALUE <span class="token operator">~&gt;</span> #checkDepthExceeded <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>call<span class="token punctuation">.</span>delegatedAuthority<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #call ACCTFROM ACCTTO ACCTCODE VALUE APPVALUE ARGS STATIC
          <span class="token operator">=&gt;</span> #let DELEGATED_ACCOUNT <span class="token operator">=</span> #asAccount<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> #in
           <span class="token punctuation">(</span>#accessAccounts DELEGATED_ACCOUNT
          <span class="token operator">~&gt;</span> #callWithCode ACCTFROM ACCTTO ACCTCODE #getAccountCode<span class="token punctuation">(</span>DELEGATED_ACCOUNT<span class="token punctuation">)</span> VALUE APPVALUE ARGS STATIC <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTCODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasauthority &lt;&lt; SCHED &gt;&gt;
       andBool #isValidDelegation <span class="token punctuation">(</span>CODE<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>call<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #call ACCTFROM ACCTTO ACCTCODE VALUE APPVALUE ARGS STATIC
          <span class="token operator">=&gt;</span> #callWithCode ACCTFROM ACCTTO ACCTCODE CODE VALUE APPVALUE ARGS STATIC
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTCODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool Ghasauthority &lt;&lt; SCHED &gt;&gt;
       orBool <span class="token punctuation">(</span>Ghasauthority &lt;&lt; SCHED&gt;&gt; andBool notBool #isValidDelegation<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>call<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #call ACCTFROM ACCTTO ACCTCODE VALUE APPVALUE ARGS STATIC
          <span class="token operator">=&gt;</span> #callWithCode ACCTFROM ACCTTO ACCTCODE <span class="token punctuation">.</span>Bytes VALUE APPVALUE ARGS STATIC
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #callWithCode ACCTFROM ACCTTO ACCTCODE BYTES VALUE APPVALUE ARGS STATIC
          <span class="token operator">=&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState
          <span class="token operator">~&gt;</span> #transferFunds ACCTFROM ACCTTO VALUE
          <span class="token operator">~&gt;</span> #mkCall ACCTFROM ACCTTO ACCTCODE BYTES APPVALUE ARGS STATIC
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #mkCall ACCTFROM ACCTTO ACCTCODE BYTES APPVALUE ARGS STATIC<span class="token punctuation">:</span><span class="token keyword">Bool</span>
          <span class="token operator">=&gt;</span> #touchAccounts ACCTFROM ACCTTO <span class="token operator">~&gt;</span> #accessAccounts ACCTFROM ACCTTO <span class="token operator">~&gt;</span> #loadProgram BYTES <span class="token operator">~&gt;</span> #initVM <span class="token operator">~&gt;</span> #precompiled<span class="token operator">?</span><span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #execute
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> USEGAS<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> CD <span class="token operator">=&gt;</span> CD <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ARGS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> APPVALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> #if USEGAS #then GCALL<span class="token punctuation">:</span>Gas #else GAVAIL<span class="token punctuation">:</span>Gas #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> #if USEGAS #then <span class="token number">0</span><span class="token punctuation">:</span>Gas #else GCALL<span class="token punctuation">:</span>Gas #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>static</span><span class="token punctuation">&gt;</span></span> OLDSTATIC<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token operator">=&gt;</span> OLDSTATIC orBool STATIC <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>static</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#precompiled?"</span> <span class="token string">"("</span> <span class="token keyword">Int</span> <span class="token string">","</span> Schedule <span class="token string">")"</span>
 <span class="token comment">// --------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>precompile<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #precompiled<span class="token operator">?</span><span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #next <span class="token punctuation">[</span> #precompiled<span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span>         #isPrecompiledAccount<span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>precompile<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #precompiled<span class="token operator">?</span><span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K                               <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> notBool #isPrecompiledAccount<span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #isPrecompiledAccount <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isPrecompiledAccount<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>isPrecompiledAccount<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>isPrecompiledAccount<span class="token punctuation">]</span><span class="token punctuation">:</span>  #isPrecompiledAccount<span class="token punctuation">(</span>ACCTCODE<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span> &lt;<span class="token keyword">Int</span> ACCTCODE andBool ACCTCODE <span class="token operator">&lt;=</span><span class="token keyword">Int</span> #precompiledAccountsUB<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#initVM"</span>
 <span class="token comment">// --------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #initVM      <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pc</span><span class="token punctuation">&gt;</span></span>           _ <span class="token operator">=&gt;</span> <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pc</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>   _ <span class="token operator">=&gt;</span> <span class="token number">0</span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>       _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wordStack</span><span class="token punctuation">&gt;</span></span>    _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>WordStack <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wordStack</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span>     _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#loadProgram"</span> Bytes <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>loadProgram<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>program<span class="token punctuation">.</span>load<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #loadProgram BYTES <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> BYTES <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jumpDests</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #computeValidJumpDests<span class="token punctuation">(</span>BYTES<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jumpDests</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#touchAccounts"</span> Account <span class="token operator">|</span> <span class="token string">"#touchAccounts"</span> Account Account
 <span class="token comment">// ----------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #touchAccounts ADDR1 ADDR2 <span class="token operator">=&gt;</span> #touchAccounts ADDR1 <span class="token operator">~&gt;</span> #touchAccounts ADDR2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #touchAccounts ADDR <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span> TOUCHED_ACCOUNTS <span class="token operator">=&gt;</span> TOUCHED_ACCOUNTS <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>ADDR<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>touchedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#accessStorage"</span> Account <span class="token keyword">Int</span>
 <span class="token comment">// ---------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessStorage ACCT INDEX <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedStorage</span><span class="token punctuation">&gt;</span></span> TS <span class="token operator">=&gt;</span> TS<span class="token punctuation">[</span>ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>-</span> <span class="token attr-name">{TS[ACCT]</span> <span class="token attr-name">orDefault</span> <span class="token attr-name"><span class="token namespace">.Set}:</span></span><span class="token punctuation">&gt;</span></span>Set <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>INDEX<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token keyword">requires</span> Ghasaccesslist &lt;&lt; SCHED &gt;&gt;
         <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessStorage _ _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool Ghasaccesslist &lt;&lt; SCHED &gt;&gt;

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#accessAccounts"</span> Account
                   <span class="token operator">|</span> <span class="token string">"#accessAccounts"</span> Set
                   <span class="token operator">|</span> <span class="token string">"#accessAccounts"</span> Account Account
                   <span class="token operator">|</span> <span class="token string">"#accessAccounts"</span> Account Account Set
 <span class="token comment">// ------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessAccounts ADDR1<span class="token punctuation">:</span>Account ADDR2<span class="token punctuation">:</span>Account ADDRSET<span class="token punctuation">:</span>Set <span class="token operator">=&gt;</span> #accessAccounts ADDR1 <span class="token operator">~&gt;</span> #accessAccounts ADDR2 <span class="token operator">~&gt;</span> #accessAccounts ADDRSET <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessAccounts ADDR1<span class="token punctuation">:</span>Account ADDR2<span class="token punctuation">:</span>Account <span class="token operator">=&gt;</span> #accessAccounts ADDR1 <span class="token operator">~&gt;</span> #accessAccounts ADDR2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessAccounts ADDR<span class="token punctuation">:</span>Account <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> TOUCHED_ACCOUNTS <span class="token operator">=&gt;</span> TOUCHED_ACCOUNTS <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>ADDR<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accessAccounts ADDRSET<span class="token punctuation">:</span>Set <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> TOUCHED_ACCOUNTS <span class="token operator">=&gt;</span> TOUCHED_ACCOUNTS <span class="token operator">|</span>Set ADDRSET <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #computeValidJumpDests<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span>             <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>computeValidJumpDests<span class="token punctuation">)</span><span class="token punctuation">,</span>    function<span class="token punctuation">,</span> memo<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                   <span class="token operator">|</span> #computeValidJumpDests<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>computeValidJumpDestsAux<span class="token punctuation">)</span><span class="token punctuation">,</span> function             <span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> padRightBytes<span class="token punctuation">(</span><span class="token punctuation">.</span>Bytes<span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>PGM<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #computeValidJumpDestsWithinBound<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>computeValidJumpDestsWithinBound<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I<span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> RESULT <span class="token keyword">requires</span> I <span class="token operator">&gt;=</span><span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>PGM<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I<span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #computeValidJumpDestsWithinBound<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I<span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token keyword">requires</span> I &lt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>PGM<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #computeValidJumpDestsWithinBound<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I<span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">,</span> RESULT<span class="token punctuation">[</span>I &lt;<span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">requires</span> PGM <span class="token punctuation">[</span> I <span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">91</span>
    <span class="token keyword">rule</span> #computeValidJumpDestsWithinBound<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I<span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #computeValidJumpDests<span class="token punctuation">(</span>PGM<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> #widthOpCode<span class="token punctuation">(</span>PGM <span class="token punctuation">[</span> I <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RESULT<span class="token punctuation">)</span> <span class="token keyword">requires</span> notBool PGM <span class="token punctuation">[</span> I <span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">91</span>
</code></pre>
<h2 id="system-calls">System Calls</h2>
<p>Address Constants</p>
<ul>
<li><code>SYSTEM_ADDRESS (0xfffffffffffffffffffffffffffffffffffffffe)</code>: Special address used for system operations</li>
<li><code>BEACON_ROOTS_ADDRESS (0x000F3df6D732807Ef1319fB7B8bB8522d0Beac02)</code>: Address for beacon chain root storage</li>
<li><code>HISTORY_STORAGE_ADDRESS (0x0000F90827F1C53a10cb7A02335B175320002935)</code>: Address for historical data storage</li>
</ul>
<p>System Transaction Configuration</p>
<ul>
<li><code>SYSTEMTXGAS (30000000)</code>: Special gas limit for system transactions</li>
<li>Gas not counted against block gas limit</li>
<li>No fee burn semantics apply to system transactions</li>
</ul>
<h2 id="system-call-operations">System Call Operations</h2>
<ul>
<li><code>#systemCall</code>: Top-level operation that initiates a system call
<ul>
<li>Preserves execution context by pushing to call stack</li>
<li>Preserves world state before making the call</li>
</ul>
</li>
<li><code>#mkSystemCall</code>: Implementation operation that constructs the actual call
<ul>
<li>Always sets caller to <code>SYSTEM_ADDRESS</code></li>
<li>Uses the system gas limit instead of standard call gas</li>
<li>Performs call with zero value transfer</li>
</ul>
</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SYSTEM_ADDRESS"</span> <span class="token punctuation">[</span>alias<span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token string">"BEACON_ROOTS_ADDRESS"</span> <span class="token punctuation">[</span>alias<span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token string">"HISTORY_STORAGE_ADDRESS"</span> <span class="token punctuation">[</span>alias<span class="token punctuation">]</span>
                 <span class="token operator">|</span> <span class="token string">"SYSTEMTXGAS"</span> <span class="token punctuation">[</span><span class="token class-name">macro</span><span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------</span>
    <span class="token keyword">rule</span> SYSTEM_ADDRESS <span class="token operator">=&gt;</span> <span class="token number">1461501637330902918203684832716283019655932542974</span>
    <span class="token keyword">rule</span> BEACON_ROOTS_ADDRESS <span class="token operator">=&gt;</span> <span class="token number">339909022928299415537769066420252604268194818</span>
    <span class="token keyword">rule</span> HISTORY_STORAGE_ADDRESS <span class="token operator">=&gt;</span> <span class="token number">21693734551179282564423033930679318143314229</span>
    <span class="token keyword">rule</span> SYSTEMTXGAS <span class="token operator">=&gt;</span> <span class="token number">30000000</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#systemCall"</span> <span class="token keyword">Int</span> Bytes   <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#systemCall<span class="token punctuation">)</span><span class="token punctuation">]</span>
                        <span class="token operator">|</span> <span class="token string">"#mkSystemCall"</span> <span class="token keyword">Int</span> Bytes <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#mkSystemCall<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #systemCall ACCTTO ARGS <span class="token operator">=&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState <span class="token operator">~&gt;</span> #mkSystemCall ACCTTO ARGS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #mkSystemCall ACCTTO ARGS <span class="token operator">=&gt;</span> #loadProgram CODE <span class="token operator">~&gt;</span> #initVM <span class="token operator">~&gt;</span> #execute <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> USEGAS<span class="token punctuation">:</span><span class="token keyword">Bool</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> CD <span class="token operator">=&gt;</span> CD <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ARGS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> #if USEGAS #then SYSTEMTXGAS<span class="token punctuation">:</span>Gas #else GAVAIL<span class="token punctuation">:</span>Gas #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> #if USEGAS #then <span class="token number">0</span><span class="token punctuation">:</span>Gas #else GCALL<span class="token punctuation">:</span>Gas #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> SYSTEM_ADDRESS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>static</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>static</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>   CODE   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #widthOpCode<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#widthOpCode<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #widthOpCode<span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> W <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">94</span> <span class="token keyword">requires</span> W <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">96</span> andBool W <span class="token operator">&lt;=</span><span class="token keyword">Int</span> <span class="token number">127</span>
    <span class="token keyword">rule</span> #widthOpCode<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#return"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
 <span class="token comment">// ----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>return<span class="token punctuation">.</span>exception<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _<span class="token punctuation">:</span>ExceptionalStatusCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #return _ _
          <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>return<span class="token punctuation">.</span>revert<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> EVMC_REVERT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState
          <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token operator">~&gt;</span> #refund GAVAIL <span class="token operator">~&gt;</span> #setLocalMem RETSTART RETWIDTH OUT
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> OUT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>return<span class="token punctuation">.</span>success<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> EVMC_SUCCESS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #dropWorldState
          <span class="token operator">~&gt;</span> <span class="token number">1</span> <span class="token operator">~&gt;</span> #push <span class="token operator">~&gt;</span> #refund GAVAIL <span class="token operator">~&gt;</span> #setLocalMem RETSTART RETWIDTH OUT
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> OUT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#refund"</span> Gas
                        <span class="token operator">|</span> <span class="token string">"#setLocalMem"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes
 <span class="token comment">// --------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>refund<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #refund G<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token operator">=&gt;</span> GAVAIL <span class="token operator">+</span>Gas G <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>refund<span class="token punctuation">.</span>noGas<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #refund _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>


    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #setLocalMem START WIDTH WS <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token operator">=&gt;</span> LM <span class="token punctuation">[</span> START <span class="token punctuation">:</span><span class="token operator">=</span> #range<span class="token punctuation">(</span>WS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> minInt<span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>WS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="ethereum-network-opcodes-1">Ethereum Network OpCodes</h2>
<h3 id="call-operations-1">Call Operations</h3>
<p>For each <code>CALL*</code> operation, we make a corresponding call to <code>#call</code> and a state-change to setup the custom parts of the calling environment.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> CallOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CALL"</span>
 <span class="token comment">// ------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>call<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALL _GCAP ACCTTO VALUE ARGSTART ARGWIDTH RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #accessAccounts ACCTTO
          <span class="token operator">~&gt;</span> #checkCall ACCTFROM VALUE
          <span class="token operator">~&gt;</span> #call ACCTFROM ACCTTO ACCTTO VALUE VALUE #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span> <span class="token boolean">false</span>
          <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> CallOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CALLCODE"</span>
 <span class="token comment">// ----------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>callcode<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CALLCODE _GCAP ACCTTO VALUE ARGSTART ARGWIDTH RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #accessAccounts ACCTTO
          <span class="token operator">~&gt;</span> #checkCall ACCTFROM VALUE
          <span class="token operator">~&gt;</span> #call ACCTFROM ACCTFROM ACCTTO VALUE VALUE #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span> <span class="token boolean">false</span>
          <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> CallSixOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"DELEGATECALL"</span>
 <span class="token comment">// -----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>delegatecall<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> DELEGATECALL _GCAP ACCTTO ARGSTART ARGWIDTH RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #accessAccounts ACCTTO
          <span class="token operator">~&gt;</span> #checkCall ACCTFROM <span class="token number">0</span>
          <span class="token operator">~&gt;</span> #call ACCTAPPFROM ACCTFROM ACCTTO <span class="token number">0</span> VALUE #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span> <span class="token boolean">false</span>
          <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span> ACCTAPPFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> VALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> CallSixOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"STATICCALL"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>staticcall<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> STATICCALL _GCAP ACCTTO ARGSTART ARGWIDTH RETSTART RETWIDTH
          <span class="token operator">=&gt;</span> #accessAccounts ACCTTO
          <span class="token operator">~&gt;</span> #checkCall ACCTFROM <span class="token number">0</span>
          <span class="token operator">~&gt;</span> #call ACCTFROM ACCTTO ACCTTO <span class="token number">0</span> <span class="token number">0</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span> <span class="token boolean">true</span>
          <span class="token operator">~&gt;</span> #return RETSTART RETWIDTH
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="account-creation%2Fdeletion">Account Creation/Deletion</h3>
<ul>
<li><code>#create____</code> transfers the endowment to the new account and triggers the execution of the initialization code.</li>
<li><code>#codeDeposit_</code> checks the result of initialization code and whether the code deposit can be paid, indicating an error if not.</li>
<li><code>#isValidCode_</code> checks if the code returned by the execution of the initialization code begins with a reserved byte. [EIP-3541]</li>
<li><code>#hasValidInitCode</code> checks the length of the transaction data in a create transaction. [EIP-3860]</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#create"</span>   <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes
                        <span class="token operator">|</span> <span class="token string">"#mkCreate"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span> Bytes
                        <span class="token operator">|</span> <span class="token string">"#incrementNonce"</span> <span class="token keyword">Int</span>
                        <span class="token operator">|</span> <span class="token string">"#checkCreate"</span> <span class="token keyword">Int</span> <span class="token keyword">Int</span>
 <span class="token comment">// --------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #create ACCTFROM ACCTTO VALUE INITCODE
          <span class="token operator">=&gt;</span> #incrementNonce ACCTFROM
          <span class="token operator">~&gt;</span> #pushCallStack <span class="token operator">~&gt;</span> #pushWorldState
          <span class="token operator">~&gt;</span> #newAccount ACCTTO
          <span class="token operator">~&gt;</span> #transferFunds ACCTFROM ACCTTO VALUE
          <span class="token operator">~&gt;</span> #mkCreate ACCTFROM ACCTTO VALUE INITCODE
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #mkCreate ACCTFROM ACCTTO VALUE INITCODE
          <span class="token operator">=&gt;</span> #touchAccounts ACCTFROM ACCTTO <span class="token operator">~&gt;</span> #accessAccounts ACCTFROM ACCTTO <span class="token operator">~&gt;</span> #loadProgram INITCODE <span class="token operator">~&gt;</span> #initVM <span class="token operator">~&gt;</span> #execute
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> USEGAS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token operator">=&gt;</span> #if USEGAS #then GCALL #else GAVAIL #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> GCALL <span class="token operator">=&gt;</span> #if USEGAS #then <span class="token number">0</span> #else GCALL #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caller</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caller</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callDepth</span><span class="token punctuation">&gt;</span></span> CD <span class="token operator">=&gt;</span> CD <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callDepth</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callValue</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> VALUE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callValue</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token operator">=&gt;</span> #if Gemptyisnonexistent &lt;&lt; SCHED &gt;&gt; #then NONCE <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> #else NONCE #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token operator">=&gt;</span> ACCTS <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #incrementNonce ACCT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token operator">=&gt;</span> NONCE <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #hasValidInitCode <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#hasValidInitCode<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #hasValidInitCode<span class="token punctuation">(</span>INITCODELEN<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> notBool Ghasmaxinitcodesize &lt;&lt; SCHED &gt;&gt; orBool INITCODELEN <span class="token operator">&lt;=</span><span class="token keyword">Int</span> maxInitCodeSize &lt; SCHED &gt;

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #isValidCode <span class="token punctuation">(</span> Bytes <span class="token punctuation">,</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#isValidCode<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #isValidCode<span class="token punctuation">(</span> OUT <span class="token punctuation">,</span>  SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Ghasrejectedfirstbyte &lt;&lt; SCHED &gt;&gt; impliesBool OUT<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">239</span> <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>OUT<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #isValidCode<span class="token punctuation">(</span>_OUT <span class="token punctuation">,</span> _SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>                                                            <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> KItem <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#codeDeposit"</span> <span class="token keyword">Int</span>
                   <span class="token operator">|</span> <span class="token string">"#mkCodeDeposit"</span> <span class="token keyword">Int</span>
                   <span class="token operator">|</span> <span class="token string">"#finishCodeDeposit"</span> <span class="token keyword">Int</span> Bytes
 <span class="token comment">// -----------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _<span class="token punctuation">:</span>ExceptionalStatusCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #codeDeposit _ <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> EVMC_REVERT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #codeDeposit _ <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState <span class="token operator">~&gt;</span> #refund GAVAIL <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> EVMC_SUCCESS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #codeDeposit ACCT <span class="token operator">=&gt;</span> #mkCodeDeposit ACCT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #mkCodeDeposit ACCT
          <span class="token operator">=&gt;</span> Gcodedeposit &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>OUT<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductGas
          <span class="token operator">~&gt;</span> #finishCodeDeposit ACCT OUT
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> OUT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>OUT<span class="token punctuation">)</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> maxCodeSize &lt; SCHED &gt; andBool #isValidCode<span class="token punctuation">(</span>OUT<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #mkCodeDeposit _ACCT <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> OUT <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span> lengthBytes<span class="token punctuation">(</span>OUT<span class="token punctuation">)</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> maxCodeSize &lt; SCHED &gt; andBool #isValidCode<span class="token punctuation">(</span>OUT<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span> <span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #finishCodeDeposit ACCT OUT
          <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #dropWorldState
          <span class="token operator">~&gt;</span> #refund GAVAIL <span class="token operator">~&gt;</span> ACCT <span class="token operator">~&gt;</span> #push
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> OUT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _<span class="token punctuation">:</span>ExceptionalStatusCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #finishCodeDeposit ACCT _
          <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #dropWorldState
          <span class="token operator">~&gt;</span> #refund GAVAIL <span class="token operator">~&gt;</span> ACCT <span class="token operator">~&gt;</span> #push
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> FRONTIER <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusCode</span><span class="token punctuation">&gt;</span></span> _<span class="token punctuation">:</span>ExceptionalStatusCode <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>statusCode</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #halt <span class="token operator">~&gt;</span> #finishCodeDeposit _ _ <span class="token operator">=&gt;</span> #popCallStack <span class="token operator">~&gt;</span> #popWorldState <span class="token operator">~&gt;</span> <span class="token number">0</span> <span class="token operator">~&gt;</span> #push <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> SCHED <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K FRONTIER

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkCreate ACCT VALUE <span class="token operator">=&gt;</span> #checkBalanceUnderflow ACCT VALUE <span class="token operator">~&gt;</span> #checkDepthExceeded <span class="token operator">~&gt;</span> #checkNonceExceeded ACCT <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p><code>CREATE</code> will attempt to <code>#create</code> the account using the initialization code and cleans up the result with <code>#codeDeposit</code>.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> TernStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CREATE"</span>
 <span class="token comment">// -------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>create<span class="token operator">-</span>valid<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CREATE VALUE MEMSTART MEMWIDTH
          <span class="token operator">=&gt;</span> #accessAccounts #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> NONCE<span class="token punctuation">)</span>
          <span class="token operator">~&gt;</span> #checkCreate ACCT VALUE
          <span class="token operator">~&gt;</span> #create ACCT #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> NONCE<span class="token punctuation">)</span> VALUE #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span>
          <span class="token operator">~&gt;</span> #codeDeposit #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> NONCE<span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span> NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #hasValidInitCode<span class="token punctuation">(</span>MEMWIDTH<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span>
      <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>create<span class="token operator">-</span>invalid<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CREATE _ _ _ <span class="token operator">=&gt;</span> #end EVMC_OUT_OF_GAS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<p><code>CREATE2</code> will attempt to <code>#create</code> the account, but with the new scheme for choosing the account address.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> QuadStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"CREATE2"</span>
 <span class="token comment">// --------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>create2<span class="token operator">-</span>valid<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CREATE2 VALUE MEMSTART MEMWIDTH SALT
          <span class="token operator">=&gt;</span> #accessAccounts #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> SALT<span class="token punctuation">,</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token operator">~&gt;</span> #checkCreate ACCT VALUE
          <span class="token operator">~&gt;</span> #create ACCT #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> SALT<span class="token punctuation">,</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span> VALUE #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span>
          <span class="token operator">~&gt;</span> #codeDeposit #newAddr<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> SALT<span class="token punctuation">,</span> #range<span class="token punctuation">(</span>LM<span class="token punctuation">,</span> MEMSTART<span class="token punctuation">,</span> MEMWIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localMem</span><span class="token punctuation">&gt;</span></span> LM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localMem</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #hasValidInitCode<span class="token punctuation">(</span>MEMWIDTH<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token punctuation">[</span>create2<span class="token operator">-</span>invalid<span class="token punctuation">]</span><span class="token punctuation">:</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> CREATE2 _ _ _ _ <span class="token operator">=&gt;</span> #end EVMC_OUT_OF_GAS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<p><code>SELFDESTRUCT</code> marks the current account for deletion and transfers funds out of the current account.
Self destructing to yourself, unlike a regular transfer, destroys the balance in the account, irreparably losing it.</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> UnStackOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SELFDESTRUCT"</span>
 <span class="token comment">// -----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SELFDESTRUCT ACCTTO <span class="token operator">=&gt;</span> #touchAccounts ACCT ACCTTO <span class="token operator">~&gt;</span> #accessAccounts ACCTTO <span class="token operator">~&gt;</span> #transferFunds ACCT ACCTTO BALFROM <span class="token operator">~&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span> SDS <span class="token operator">=&gt;</span> SDS <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BALFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> CA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>notBool Ghaseip6780 &lt;&lt; SCHED &gt;&gt;<span class="token punctuation">)</span> orBool ACCT in CA<span class="token punctuation">)</span>
       andBool ACCT <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> ACCTTO

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SELFDESTRUCT ACCT <span class="token operator">=&gt;</span> #touchAccounts ACCT <span class="token operator">~&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span> SDS <span class="token operator">=&gt;</span> SDS <span class="token operator">|</span>Set SetItem<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> CA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>notBool Ghaseip6780 &lt;&lt; SCHED &gt;&gt;<span class="token punctuation">)</span> orBool ACCT in CA<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SELFDESTRUCT ACCTTO <span class="token operator">=&gt;</span> #touchAccounts ACCT ACCTTO <span class="token operator">~&gt;</span> #accessAccounts ACCTTO <span class="token operator">~&gt;</span> #transferFunds ACCT ACCTTO BALFROM <span class="token operator">~&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BALFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> CA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghaseip6780 &lt;&lt; SCHED &gt;&gt; andBool <span class="token punctuation">(</span>notBool ACCT in CA<span class="token punctuation">)</span>
       andBool ACCT <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> ACCTTO

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SELFDESTRUCT ACCT <span class="token operator">=&gt;</span> #touchAccounts ACCT <span class="token operator">~&gt;</span> #accessAccounts ACCT <span class="token operator">~&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>createdAccounts</span><span class="token punctuation">&gt;</span></span> CA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>createdAccounts</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghaseip6780 &lt;&lt; SCHED &gt;&gt; andBool <span class="token punctuation">(</span>notBool ACCT in CA<span class="token punctuation">)</span>
</code></pre>
<h2 id="precompiled-contracts">Precompiled Contracts</h2>
<ul>
<li><code>#precompiled</code> is a placeholder for the pre-compiled contracts of a given schedule. These contracts are located at contiguous addresses starting from 1.</li>
<li><code>#precompiledAccountsUB</code>  returns the highest address (upper bound) of the precompiled contract accounts</li>
<li><code>#precompiledAccountsSet</code> returns the set of addresses of the precompiled contract accounts</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> NullStackOp   <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> PrecompiledOp
    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #precompiled <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#precompiled<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ECREC
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SHA256
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> RIP160
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ID
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MODEXP
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ECADD
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ECMUL
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ECPAIRING
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLAKE2F
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> KZGPOINTEVAL
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_G1ADD
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_G1MSM
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_G2ADD
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_G2MSM
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_PAIRING_CHECK
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_MAP_FP_TO_G1
    <span class="token keyword">rule</span> #precompiled<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLS12_MAP_FP2_TO_G2


    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #precompiledAccountsUB <span class="token punctuation">(</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#precompiledAccountsUB<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>DEFAULT<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> <span class="token number">4</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>FRONTIER<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>DEFAULT<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>HOMESTEAD<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>FRONTIER<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>TANGERINE_WHISTLE<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>HOMESTEAD<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>SPURIOUS_DRAGON<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>TANGERINE_WHISTLE<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>BYZANTIUM<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token number">8</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>CONSTANTINOPLE<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>BYZANTIUM<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>PETERSBURG<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>CONSTANTINOPLE<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>ISTANBUL<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> <span class="token number">9</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>BERLIN<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>ISTANBUL<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>LONDON<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>BERLIN<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>MERGE<span class="token punctuation">)</span>             <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>LONDON<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>SHANGHAI<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> #precompiledAccountsUB<span class="token punctuation">(</span>MERGE<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>CANCUN<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> <span class="token number">10</span>
    <span class="token keyword">rule</span> #precompiledAccountsUB<span class="token punctuation">(</span>PRAGUE<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> <span class="token number">17</span>


    <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #precompiledAccountsSet    <span class="token punctuation">(</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#precompiledAccountsSet<span class="token punctuation">)</span><span class="token punctuation">,</span>    function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
    <span class="token keyword">syntax</span> Set <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #precompiledAccountsSetAux <span class="token punctuation">(</span> <span class="token keyword">Int</span>      <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#precompiledAccountsSetAux<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #precompiledAccountsSet<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #precompiledAccountsSetAux<span class="token punctuation">(</span>#precompiledAccountsUB<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #precompiledAccountsSetAux<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Set <span class="token keyword">requires</span> N <span class="token operator">&lt;=</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #precompiledAccountsSetAux<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> SetItem<span class="token punctuation">(</span>N<span class="token punctuation">)</span> #precompiledAccountsSetAux<span class="token punctuation">(</span>N <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>owise<span class="token punctuation">,</span> preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
</code></pre>
<ul>
<li><code>ECREC</code> performs ECDSA public key recovery.</li>
<li><code>SHA256</code> performs the SHA2-256 hash function.</li>
<li><code>RIP160</code> performs the RIPEMD-160 hash function.</li>
<li><code>ID</code> is the identity function (copies input to output).</li>
<li><code>MODEXP</code> performs arbitrary-precision modular exponentiation.</li>
<li><code>ECADD</code>  performs point addition on the elliptic curve alt_bn128.</li>
<li><code>ECMUL</code> performs scalar multiplication on the elliptic curve alt_bn128.</li>
<li><code>ECPAIRING</code> performs an optimal ate pairing check on the elliptic curve alt_bn128.</li>
<li><code>BLAKE2F</code> performs the compression function F used in the BLAKE2 hashing algorithm.</li>
<li><code>KZGPOINTEVAL</code> performs the point evaluation precompile that is part of EIP 4844.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ECREC"</span>
 <span class="token comment">// --------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ECREC <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #ecrec<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #ecrec <span class="token punctuation">(</span> Bytes <span class="token punctuation">,</span> Bytes <span class="token punctuation">,</span> Bytes <span class="token punctuation">,</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ecrec<span class="token punctuation">)</span><span class="token punctuation">,</span>    function<span class="token punctuation">,</span> total<span class="token punctuation">,</span> smtlib<span class="token punctuation">(</span>ecrec<span class="token punctuation">)</span><span class="token punctuation">]</span>
                   <span class="token operator">|</span> #ecrec <span class="token punctuation">(</span> Account <span class="token punctuation">)</span>                       <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ecrecAux<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total               <span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span>ecrec<span class="token punctuation">]</span><span class="token punctuation">:</span> #ecrec<span class="token punctuation">(</span>HASH<span class="token punctuation">,</span> SIGV<span class="token punctuation">,</span> SIGR<span class="token punctuation">,</span> SIGS<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #ecrec<span class="token punctuation">(</span>#sender<span class="token punctuation">(</span>HASH<span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>SIGV<span class="token punctuation">)</span><span class="token punctuation">,</span> SIGR<span class="token punctuation">,</span> SIGS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> #ecrec<span class="token punctuation">(</span><span class="token punctuation">.</span>Account<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes
    <span class="token keyword">rule</span> #ecrec<span class="token punctuation">(</span>N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"SHA256"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> SHA256 <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #parseHexBytes<span class="token punctuation">(</span>Sha256<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"RIP160"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> RIP160 <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #parseHexBytes<span class="token punctuation">(</span>RipEmd160<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ID"</span>
 <span class="token comment">// -----------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ID <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"MODEXP"</span>
 <span class="token comment">// ---------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MODEXP <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #modexp1<span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> maxInt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #modexp1 <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#modexp1<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
                   <span class="token operator">|</span> #modexp2 <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#modexp2<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
                   <span class="token operator">|</span> #modexp3 <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#modexp3<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
                   <span class="token operator">|</span> #modexp4 <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>         <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#modexp4<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #modexp1<span class="token punctuation">(</span>BASELEN<span class="token punctuation">,</span> EXPLEN<span class="token punctuation">,</span>   MODLEN<span class="token punctuation">,</span> DATA<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #modexp2<span class="token punctuation">(</span>#asInteger<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> BASELEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EXPLEN<span class="token punctuation">,</span> MODLEN<span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> BASELEN<span class="token punctuation">,</span> maxInt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> BASELEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">requires</span> MODLEN <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #modexp1<span class="token punctuation">(</span>_<span class="token punctuation">,</span>       _<span class="token punctuation">,</span>        <span class="token number">0</span><span class="token punctuation">,</span>      _<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes
    <span class="token keyword">rule</span> #modexp2<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span>    EXPLEN<span class="token punctuation">,</span>   MODLEN<span class="token punctuation">,</span> DATA<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #modexp3<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span> #asInteger<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> EXPLEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MODLEN<span class="token punctuation">,</span> #range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> EXPLEN<span class="token punctuation">,</span> maxInt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> EXPLEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #modexp3<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span>    EXPONENT<span class="token punctuation">,</span> MODLEN<span class="token punctuation">,</span> DATA<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span>MODLEN<span class="token punctuation">,</span> #modexp4<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span> EXPONENT<span class="token punctuation">,</span> #asInteger<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> MODLEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #modexp4<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span>    EXPONENT<span class="token punctuation">,</span> MODULUS<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> #asByteStack<span class="token punctuation">(</span>powmod<span class="token punctuation">(</span>BASE<span class="token punctuation">,</span> EXPONENT<span class="token punctuation">,</span> MODULUS<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ECADD"</span>
 <span class="token comment">// --------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ECADD <span class="token operator">=&gt;</span> #ecadd<span class="token punctuation">(</span><span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #ecadd<span class="token punctuation">(</span>G1Point<span class="token punctuation">,</span> G1Point<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ecadd<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #ecadd<span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool isValidPointWrapper<span class="token punctuation">(</span>P1<span class="token punctuation">)</span> orBool notBool isValidPointWrapper<span class="token punctuation">(</span>P2<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #ecadd<span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #point<span class="token punctuation">(</span>BN128AddWrapper<span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> isValidPointWrapper<span class="token punctuation">(</span>P1<span class="token punctuation">)</span> andBool isValidPointWrapper<span class="token punctuation">(</span>P2<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ECMUL"</span>
 <span class="token comment">// --------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ECMUL <span class="token operator">=&gt;</span> #ecmul<span class="token punctuation">(</span><span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #ecmul<span class="token punctuation">(</span>G1Point<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ecmul<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #ecmul<span class="token punctuation">(</span>P<span class="token punctuation">,</span> _S<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool isValidPointWrapper<span class="token punctuation">(</span>P<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #ecmul<span class="token punctuation">(</span>P<span class="token punctuation">,</span>  S<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #point<span class="token punctuation">(</span>BN128MulWrapper<span class="token punctuation">(</span>P<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> isValidPointWrapper<span class="token punctuation">(</span>P<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #point <span class="token punctuation">(</span> G1Point <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#point<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #point<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>Bytes #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"ECPAIRING"</span>
 <span class="token comment">// ------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ECPAIRING <span class="token operator">=&gt;</span> #ecpairing<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> DATA<span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> modInt <span class="token number">192</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> ECPAIRING <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> modInt <span class="token number">192</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #ecpairing<span class="token punctuation">(</span>List<span class="token punctuation">,</span> List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> Bytes<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#ecpairing<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// ----------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">.</span>K <span class="token operator">=&gt;</span> #checkPoint<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #ecpairing<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">.</span>List <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span><span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> _<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">.</span>List <span class="token operator">=&gt;</span> ListItem<span class="token punctuation">(</span><span class="token punctuation">(</span>#asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> x #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> x #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> _<span class="token punctuation">,</span> I <span class="token operator">=&gt;</span> I <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">192</span><span class="token punctuation">,</span> DATA<span class="token punctuation">,</span> LEN<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> I <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> LEN
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #ecpairing<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> LEN<span class="token punctuation">,</span> _<span class="token punctuation">,</span> LEN<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>bool2Word<span class="token punctuation">(</span>BN128AtePairingWrapper<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#checkPoint"</span>
 <span class="token comment">// -----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>#checkPoint <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #ecpairing<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>AK<span class="token punctuation">:</span><span class="token punctuation">:</span>G1Point<span class="token punctuation">)</span> _<span class="token punctuation">,</span> ListItem<span class="token punctuation">(</span>BK<span class="token punctuation">:</span><span class="token punctuation">:</span>G2Point<span class="token punctuation">)</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> isValidPointWrapper<span class="token punctuation">(</span>AK<span class="token punctuation">)</span> andBool isValidPointWrapper<span class="token punctuation">(</span>BK<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #checkPoint <span class="token operator">~&gt;</span> #ecpairing<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>AK<span class="token punctuation">:</span><span class="token punctuation">:</span>G1Point<span class="token punctuation">)</span> _<span class="token punctuation">,</span> ListItem<span class="token punctuation">(</span>BK<span class="token punctuation">:</span><span class="token punctuation">:</span>G2Point<span class="token punctuation">)</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool isValidPointWrapper<span class="token punctuation">(</span>AK<span class="token punctuation">)</span> orBool notBool isValidPointWrapper<span class="token punctuation">(</span>BK<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLAKE2F"</span>
 <span class="token comment">// ----------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLAKE2F <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #parseByteStack<span class="token punctuation">(</span> Blake2CompressWrapper<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">213</span>
       andBool DATA<span class="token punctuation">[</span><span class="token number">212</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> <span class="token number">1</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLAKE2F <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">213</span>
       andBool DATA<span class="token punctuation">[</span><span class="token number">212</span><span class="token punctuation">]</span> &gt;<span class="token keyword">Int</span> <span class="token number">1</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLAKE2F <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">213</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"KZGPOINTEVAL"</span>
 <span class="token comment">// ---------------------------------------</span>
    <span class="token comment">// FIELD_ELEMENTS_PER_BLOB = 4096</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> KZGPOINTEVAL <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> Int2Bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">,</span> BE<span class="token punctuation">)</span> <span class="token operator">+</span>Bytes Int2Bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> blsModulus<span class="token punctuation">,</span> BE<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">192</span>
       andBool #kzg2vh<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span>K substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
       andBool Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">blsModulus</span>
       <span class="token attr-name">andBool</span> <span class="token attr-name">Bytes2Int(substrBytes(DATA,</span> <span class="token attr-name">64,</span> <span class="token attr-name">96),</span> <span class="token attr-name">BE,</span> <span class="token attr-name">Unsigned)</span> <span class="token attr-name">&lt;Int</span> <span class="token attr-name">blsModulus</span>
       <span class="token attr-name">andBool</span> <span class="token attr-name">verifyKZGProofWrapper(substrBytes(DATA,</span> <span class="token attr-name">96,</span> <span class="token attr-name">144),</span> <span class="token attr-name">substrBytes(DATA,</span> <span class="token attr-name">32,</span> <span class="token attr-name">64),</span> <span class="token attr-name">substrBytes(DATA,</span> <span class="token attr-name">64,</span> <span class="token attr-name">96),</span> <span class="token attr-name">substrBytes(DATA,</span> <span class="token attr-name">144,</span> <span class="token attr-name">192))</span>

    <span class="token attr-name">rule</span> <span class="token attr-name">&lt;k</span><span class="token punctuation">&gt;</span></span> KZGPOINTEVAL <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">192</span>
       orBool #kzg2vh<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
       orBool Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> blsModulus
       orBool Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> blsModulus
       orBool notBool verifyKZGProofWrapper<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #kzg2vh <span class="token punctuation">(</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#kzg2vh<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------</span>
    <span class="token comment">// VERSIONED_HASH_VERSION_KZG = 0x01</span>
    <span class="token keyword">rule</span> #kzg2vh <span class="token punctuation">(</span> C <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Sha256rawWrapper<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span> &lt;<span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
</code></pre>
<ul>
<li><code>BLS12_G1ADD</code> performs point addition in G1 (curve over base prime field)</li>
<li><code>BLS12_G1MSM</code> performs multi-scalar-multiplication (MSM) in G1 (curve over base prime field)</li>
<li><code>BLS12_G2ADD</code> performs point addition in G2 (curve over quadratic extension of the base prime field)</li>
<li><code>BLS12_G2MSM</code> to perform multi-scalar-multiplication (MSM) in G2 (curve over quadratic extension of the base prime field)</li>
<li><code>BLS12_PAIRING_CHECK</code> performs a pairing operations between a set of pairs of (G1, G2) points</li>
<li><code>BLS12_MAP_FP_TO_G1</code> maps base field element into the G1 point</li>
<li><code>BLS12_MAP_FP2_TO_G2</code> maps extension field element into the G2 point</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #bls12point <span class="token punctuation">(</span> G1Point <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#bls12point1<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #bls12point<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>Bytes #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #bls12point <span class="token punctuation">(</span> G2Point <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#bls12point2<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #bls12point<span class="token punctuation">(</span><span class="token punctuation">(</span>X0 x X1<span class="token punctuation">,</span> Y0 x Y1<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>X0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>Bytes #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>X1<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">+</span>Bytes #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>Y0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>Bytes #padToWidth<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> #asByteStack<span class="token punctuation">(</span>Y1<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isValidBLS12Coordinate <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isValidBLS12Coordinate<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
  <span class="token comment">// -----------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> isValidBLS12Coordinate<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> isValidBLS12Fp<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isValidBLS12Fp <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isValidBLS12Fp<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
  <span class="token comment">// -------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> isValidBLS12Fp<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> X <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span> andBool X &lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token number">384</span><span class="token punctuation">)</span> andBool X &lt;<span class="token keyword">Int</span> BLS12_FIELD_MODULUS

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> isValidBLS12Scalar <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>isValidBLS12Scalar<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
  <span class="token comment">// ---------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> isValidBLS12Scalar<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> X <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">0</span> andBool X &lt;<span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> &lt;&lt;<span class="token keyword">Int</span> <span class="token number">256</span><span class="token punctuation">)</span>
</code></pre>
<pre><code class="language-k">    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_G1ADD"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G1ADD <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>
            _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>BLS12G1Add
                    <span class="token punctuation">(</span>   <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">,</span>   <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">256</span>
        andBool bls12ValidForAdd
            <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G1ADD <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">256</span>
        orBool notBool bls12ValidForAdd
            <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> bls12ValidForAdd<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> bls12ValidForAdd<span class="token punctuation">(</span>X0<span class="token punctuation">,</span> Y0<span class="token punctuation">,</span> X1<span class="token punctuation">,</span> Y1<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>X0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>X1<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y1<span class="token punctuation">)</span>
            andBool BLS12G1OnCurve<span class="token punctuation">(</span><span class="token punctuation">(</span>X0<span class="token punctuation">,</span> Y0<span class="token punctuation">)</span><span class="token punctuation">)</span>
            andBool BLS12G1OnCurve<span class="token punctuation">(</span><span class="token punctuation">(</span>X1<span class="token punctuation">,</span> Y1<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_G1MSM"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token comment">// Note that the implementation of `g1_lincomb_fast` has the following comment:</span>
    <span class="token comment">//</span>
    <span class="token comment">//  * @remark While this function is significantly faster than g1_lincomb_naive(), we refrain from</span>
    <span class="token comment">//  * using it in security-critical places (like verification) because the blst Pippenger code has not</span>
    <span class="token comment">//  * been audited. In those critical places, we prefer using g1_lincomb_naive() which is much simpler.</span>
    <span class="token comment">//</span>
    <span class="token comment">// https://github.com/ethereum/c-kzg-4844/blob/cc33b779cd3a227f51b35ce519a83cf91d81ccea/src/common/lincomb.c#L54-L56</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G1MSM <span class="token operator">=&gt;</span> bls12G1Msm<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> g1MsmResult<span class="token punctuation">(</span>P<span class="token punctuation">:</span>G1Point<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> g1MsmError <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> G1MsmResult <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"g1MsmError"</span> <span class="token operator">|</span> g1MsmResult<span class="token punctuation">(</span>G1Point<span class="token punctuation">)</span>
                         <span class="token operator">|</span> bls12G1Msm<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>bls12G1Msm<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                         <span class="token operator">|</span> #bls12G1Msm<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> List<span class="token punctuation">,</span> List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                         <span class="token operator">|</span> #bls12G1MsmCheck<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> List<span class="token punctuation">,</span> List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g1MsmError <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">rule</span> #bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g1MsmResult<span class="token punctuation">(</span>BLS12G1Msm<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> scalars<span class="token punctuation">:</span> Ss<span class="token punctuation">,</span> points<span class="token punctuation">:</span> Ps<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g1MsmError
        <span class="token keyword">requires</span> <span class="token number">0</span> &lt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> andBool lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> &lt;<span class="token keyword">Int</span> <span class="token number">160</span>
    <span class="token keyword">rule</span> #bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> #bls12G1MsmCheck
                <span class="token punctuation">(</span> substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ps<span class="token punctuation">,</span> Ss
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token keyword">requires</span> <span class="token number">160</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #bls12G1MsmCheck<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">,</span> X<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> #bls12G1Msm<span class="token punctuation">(</span>B<span class="token punctuation">,</span> Ps ListItem<span class="token punctuation">(</span> <span class="token punctuation">(</span> X <span class="token punctuation">,</span> Y <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> Ss ListItem<span class="token punctuation">(</span> N <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">requires</span> isValidBLS12Coordinate<span class="token punctuation">(</span>X<span class="token punctuation">)</span> andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>
        andBool isValidBLS12Scalar<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
        andBool BLS12G1InSubgroup<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #bls12G1MsmCheck<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g1MsmError <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_G2ADD"</span>
 <span class="token comment">// --------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G2ADD <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>
            _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>BLS12G2Add
                    <span class="token punctuation">(</span>   <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">,</span>   <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">512</span>
        andBool bls12ValidForAdd2
            <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G2ADD <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">512</span>
        orBool notBool bls12ValidForAdd2
            <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">448</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> bls12ValidForAdd2<span class="token punctuation">(</span><span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span>  <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> bls12ValidForAdd2<span class="token punctuation">(</span>PX0<span class="token punctuation">,</span> PX1<span class="token punctuation">,</span> PY0<span class="token punctuation">,</span> PY1<span class="token punctuation">,</span> QX0<span class="token punctuation">,</span> QX1<span class="token punctuation">,</span> QY0<span class="token punctuation">,</span> QY1<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>PX0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>PX1<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>PY0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>PY1<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>QX0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>QX1<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>QY0<span class="token punctuation">)</span>
            andBool isValidBLS12Coordinate<span class="token punctuation">(</span>QY1<span class="token punctuation">)</span>
            andBool BLS12G2OnCurve<span class="token punctuation">(</span><span class="token punctuation">(</span>PX0 x PX1<span class="token punctuation">,</span> PY0 x PY1<span class="token punctuation">)</span><span class="token punctuation">)</span>
            andBool BLS12G2OnCurve<span class="token punctuation">(</span><span class="token punctuation">(</span>QX0 x QX1<span class="token punctuation">,</span> QY0 x QY1<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_G2MSM"</span>
 <span class="token comment">// -------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_G2MSM <span class="token operator">=&gt;</span> bls12G2Msm<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> g2MsmResult<span class="token punctuation">(</span>P<span class="token punctuation">:</span>G2Point<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> g2MsmError <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> G2MsmResult <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"g2MsmError"</span> <span class="token operator">|</span> g2MsmResult<span class="token punctuation">(</span>G2Point<span class="token punctuation">)</span>
                         <span class="token operator">|</span> bls12G2Msm<span class="token punctuation">(</span>Bytes<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>bls12G2Msm<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                         <span class="token operator">|</span> #bls12G2Msm<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> List<span class="token punctuation">,</span> List<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                         <span class="token operator">|</span> #bls12G2MsmCheck<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> List<span class="token punctuation">,</span> List<span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">,</span> <span class="token keyword">Int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g2MsmError <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">rule</span> #bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g2MsmResult<span class="token punctuation">(</span>BLS12G2Msm<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> scalars<span class="token punctuation">:</span> Ss<span class="token punctuation">,</span> points<span class="token punctuation">:</span> Ps<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> #bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g2MsmError
        <span class="token keyword">requires</span> <span class="token number">0</span> &lt;<span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> andBool lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> &lt;<span class="token keyword">Int</span> <span class="token number">288</span>
    <span class="token keyword">rule</span> #bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> #bls12G2MsmCheck
                <span class="token punctuation">(</span> substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">288</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ps<span class="token punctuation">,</span> Ss
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">288</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token keyword">requires</span> <span class="token number">288</span> <span class="token operator">&lt;=</span><span class="token keyword">Int</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #bls12G2MsmCheck<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> Ps<span class="token punctuation">:</span>List<span class="token punctuation">,</span> Ss<span class="token punctuation">:</span>List<span class="token punctuation">,</span> X0<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> X1<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> Y0<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> Y1<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">,</span> N<span class="token punctuation">:</span><span class="token keyword">Int</span><span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> #bls12G2Msm<span class="token punctuation">(</span>B<span class="token punctuation">,</span> Ps ListItem<span class="token punctuation">(</span> <span class="token punctuation">(</span> X0 x X1<span class="token punctuation">,</span> Y0 x Y1 <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> Ss ListItem<span class="token punctuation">(</span> N <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">requires</span> isValidBLS12Coordinate<span class="token punctuation">(</span>X0<span class="token punctuation">)</span> andBool isValidBLS12Coordinate<span class="token punctuation">(</span>X1<span class="token punctuation">)</span>
        andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y0<span class="token punctuation">)</span> andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y1<span class="token punctuation">)</span>
        andBool isValidBLS12Scalar<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
        andBool BLS12G2InSubgroup<span class="token punctuation">(</span><span class="token punctuation">(</span> X0 x X1<span class="token punctuation">,</span> Y0 x Y1 <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #bls12G2MsmCheck<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> g2MsmError  <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_PAIRING_CHECK"</span>
 <span class="token comment">// ----------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_PAIRING_CHECK <span class="token operator">=&gt;</span> bls12PairingCheck<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">,</span> <span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> bls12PairingResult<span class="token punctuation">(</span>B<span class="token punctuation">:</span><span class="token keyword">Bool</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #if B #then Int2Bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> BE<span class="token punctuation">:</span>Endianness<span class="token punctuation">)</span> #else Int2Bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> BE<span class="token punctuation">:</span>Endianness<span class="token punctuation">)</span> #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> bls12PairingError <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> Bls12PairingResult <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"bls12PairingError"</span> <span class="token operator">|</span> bls12PairingResult<span class="token punctuation">(</span><span class="token keyword">Bool</span><span class="token punctuation">)</span>
                                <span class="token operator">|</span> bls12PairingCheck<span class="token punctuation">(</span>Bytes<span class="token punctuation">,</span> List<span class="token punctuation">,</span> List<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>bls12PairingCheck<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> bls12PairingCheck<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> L1<span class="token punctuation">:</span>List<span class="token punctuation">,</span> L2<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> bls12PairingResult<span class="token punctuation">(</span>BLS12PairingCheck<span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span>
          andBool validBls12G1PairingPoints<span class="token punctuation">(</span>L1<span class="token punctuation">)</span>
          andBool validBls12G2PairingPoints<span class="token punctuation">(</span>L2<span class="token punctuation">)</span>
          andBool size<span class="token punctuation">(</span>L1<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> size<span class="token punctuation">(</span>L2<span class="token punctuation">)</span>
          andBool size<span class="token punctuation">(</span>L1<span class="token punctuation">)</span> &gt;<span class="token keyword">Int</span> <span class="token number">0</span>

    <span class="token keyword">rule</span> bls12PairingCheck<span class="token punctuation">(</span>B<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> L1<span class="token punctuation">:</span>List<span class="token punctuation">,</span> L2<span class="token punctuation">:</span>List<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> bls12PairingCheck
            <span class="token punctuation">(</span> substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">,</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span> L1 ListItem<span class="token punctuation">(</span>
                <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
              <span class="token punctuation">)</span>
            <span class="token punctuation">,</span> L2 ListItem<span class="token punctuation">(</span>
                <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                x Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">384</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
              <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token keyword">Int</span> <span class="token number">384</span>

    <span class="token keyword">rule</span> bls12PairingCheck<span class="token punctuation">(</span>_<span class="token punctuation">:</span>Bytes<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">,</span> _<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> bls12PairingError <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> validBls12G1PairingPoints<span class="token punctuation">(</span>List<span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                  <span class="token operator">|</span> validBls12G1PairingPoint<span class="token punctuation">(</span>G1Point<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
<span class="token comment">// --------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> validBls12G1PairingPoints<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> validBls12G1PairingPoints<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>P<span class="token punctuation">:</span>G1Point<span class="token punctuation">)</span> L<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> validBls12G1PairingPoints<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
      <span class="token keyword">requires</span> validBls12G1PairingPoint<span class="token punctuation">(</span>P<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> validBls12G1PairingPoints<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> validBls12G1PairingPoint<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> #as P<span class="token punctuation">:</span>G1Point<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> isValidBLS12Coordinate<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
          andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>
          andBool BLS12G1InSubgroup<span class="token punctuation">(</span>P<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> validBls12G2PairingPoints<span class="token punctuation">(</span>List<span class="token punctuation">)</span>   <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                  <span class="token operator">|</span> validBls12G2PairingPoint<span class="token punctuation">(</span>G2Point<span class="token punctuation">)</span> <span class="token punctuation">[</span>function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
<span class="token comment">// --------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> validBls12G2PairingPoints<span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> validBls12G2PairingPoints<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>P<span class="token punctuation">:</span>G2Point<span class="token punctuation">)</span> L<span class="token punctuation">:</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> validBls12G2PairingPoints<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
      <span class="token keyword">requires</span> validBls12G2PairingPoint<span class="token punctuation">(</span>P<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> validBls12G2PairingPoints<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> validBls12G2PairingPoint<span class="token punctuation">(</span><span class="token punctuation">(</span>X0 x X1<span class="token punctuation">,</span> Y0 x Y1<span class="token punctuation">)</span> #as P<span class="token punctuation">:</span>G2Point<span class="token punctuation">)</span>
        <span class="token operator">=&gt;</span> isValidBLS12Coordinate<span class="token punctuation">(</span>X0<span class="token punctuation">)</span>
          andBool isValidBLS12Coordinate<span class="token punctuation">(</span>X1<span class="token punctuation">)</span>
          andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y0<span class="token punctuation">)</span>
          andBool isValidBLS12Coordinate<span class="token punctuation">(</span>Y1<span class="token punctuation">)</span>
          andBool BLS12G2InSubgroup<span class="token punctuation">(</span>P<span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_MAP_FP_TO_G1"</span>
 <span class="token comment">// ---------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_MAP_FP_TO_G1 <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>BLS12MapFpToG1<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">64</span>
       andBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_MAP_FP_TO_G1 <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">64</span>
        orBool notBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>


    <span class="token keyword">syntax</span> PrecompiledOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"BLS12_MAP_FP2_TO_G2"</span>
 <span class="token comment">// ----------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_MAP_FP2_TO_G2 <span class="token operator">=&gt;</span> #end EVMC_SUCCESS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>output</span><span class="token punctuation">&gt;</span></span>
            _ <span class="token operator">=&gt;</span> #bls12point<span class="token punctuation">(</span>BLS12MapFp2ToG2
                    <span class="token punctuation">(</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                    <span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>output</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">128</span>
       andBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
       andBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> BLS12_MAP_FP2_TO_G2 <span class="token operator">=&gt;</span> #end EVMC_PRECOMPILE_FAILURE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> lengthBytes<span class="token punctuation">(</span> DATA <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span><span class="token keyword">Int</span> <span class="token number">128</span>
        orBool notBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
        orBool notBool isValidBLS12Fp<span class="token punctuation">(</span>Bytes2Int<span class="token punctuation">(</span>substrBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h1 id="ethereum-gas-calculation">Ethereum Gas Calculation</h1>
<h2 id="overall-gas">Overall Gas</h2>
<ul>
<li><code>#gas</code> calculates how much gas this operation costs, and takes into account the memory consumed.</li>
<li><code>#deductGas</code> is used to check that there won't be a gas underflow (throwing <code>EVMC_OUT_OF_GAS</code> if so), and deducts the gas if not.</li>
<li><code>#deductMemory</code> checks that access to memory stay within sensible bounds (and deducts the correct amount of gas for it), throwing <code>EVMC_INVALID_MEMORY_ACCESS</code> if bad access happens.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#gas"</span> <span class="token string">"["</span> OpCode <span class="token string">","</span> OpCode <span class="token string">"]"</span>
 <span class="token comment">// ------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gas <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> AOP <span class="token punctuation">]</span>
          <span class="token operator">=&gt;</span> #memory <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> AOP <span class="token punctuation">]</span>
          <span class="token operator">~&gt;</span> #gas <span class="token punctuation">[</span> AOP <span class="token punctuation">]</span>
          <span class="token operator">~&gt;</span> #access <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> AOP <span class="token punctuation">]</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gas <span class="token punctuation">[</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gas <span class="token punctuation">[</span> OP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> OP<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductGas <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #memory <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> AOP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #memory<span class="token punctuation">(</span>AOP<span class="token punctuation">,</span> MU<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductMemory <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memoryUsed</span><span class="token punctuation">&gt;</span></span> MU <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>memoryUsed</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #usesMemory<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>

   <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #memory <span class="token punctuation">[</span> _ <span class="token punctuation">,</span> _ <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#gas"</span>    <span class="token string">"["</span> OpCode <span class="token string">"]"</span> <span class="token operator">|</span> <span class="token string">"#deductGas"</span> <span class="token operator">|</span> <span class="token string">"#deductMemoryGas"</span>
                        <span class="token operator">|</span> <span class="token string">"#memory"</span> <span class="token string">"["</span> OpCode <span class="token string">","</span> OpCode <span class="token string">"]"</span> <span class="token operator">|</span> <span class="token string">"#deductMemory"</span>
 <span class="token comment">// ---------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> MU<span class="token string">':Int ~&gt; #deductMemory =&gt; (Cmem(SCHED, MU'</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token keyword">Int</span> Cmem<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MU<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductMemoryGas <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memoryUsed</span><span class="token punctuation">&gt;</span></span> MU <span class="token operator">=&gt;</span> MU' <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>memoryUsed</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> _G<span class="token punctuation">:</span>Gas <span class="token operator">~&gt;</span> <span class="token punctuation">(</span>#deductMemoryGas <span class="token operator">=&gt;</span> #deductGas<span class="token punctuation">)</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token comment">//Required for verification</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span>  G<span class="token punctuation">:</span>Gas <span class="token operator">~&gt;</span> #deductGas <span class="token operator">=&gt;</span> #end EVMC_OUT_OF_GAS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL<span class="token punctuation">:</span>Gas                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Gas</span> <span class="token attr-name">G</span>
    <span class="token attr-name">rule</span> <span class="token attr-name">&lt;k</span><span class="token punctuation">&gt;</span></span>  G<span class="token punctuation">:</span>Gas <span class="token operator">~&gt;</span> #deductGas <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K                    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL<span class="token punctuation">:</span>Gas <span class="token operator">=&gt;</span> GAVAIL <span class="token operator">-</span>Gas G <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">true</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> G <span class="token operator">&lt;=</span>Gas GAVAIL
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span>  _<span class="token punctuation">:</span>Gas <span class="token operator">~&gt;</span> #deductGas <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K                    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useGas</span><span class="token punctuation">&gt;</span></span> <span class="token boolean">false</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useGas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #inStorage     <span class="token punctuation">(</span> Map   <span class="token punctuation">,</span> Account <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#inStorage<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                  <span class="token operator">|</span> #inStorageAux1 <span class="token punctuation">(</span> KItem <span class="token punctuation">,</span>           <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#inStorageAux1<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
                  <span class="token operator">|</span> #inStorageAux2 <span class="token punctuation">(</span> Set   <span class="token punctuation">,</span>           <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#inStorageAux2<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #inStorage<span class="token punctuation">(</span>TS<span class="token punctuation">,</span> ACCT<span class="token punctuation">,</span> KEY<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #inStorageAux1<span class="token punctuation">(</span>TS<span class="token punctuation">[</span>ACCT<span class="token punctuation">]</span><span class="token punctuation">,</span> KEY<span class="token punctuation">)</span> <span class="token keyword">requires</span> ACCT in_keys<span class="token punctuation">(</span>TS<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #inStorage<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token boolean">false</span>                         <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> #inStorageAux1<span class="token punctuation">(</span>KEYS<span class="token punctuation">:</span>Set<span class="token punctuation">,</span> KEY<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #inStorageAux2<span class="token punctuation">(</span>KEYS<span class="token punctuation">,</span> KEY<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #inStorageAux1<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> <span class="token boolean">false</span>                     <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">rule</span> #inStorageAux2<span class="token punctuation">(</span>KEYS<span class="token punctuation">,</span> KEY<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>  <span class="token keyword">requires</span> KEY in KEYS
    <span class="token keyword">rule</span> #inStorageAux2<span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h2 id="memory-consumption">Memory Consumption</h2>
<p>Memory consumed is tracked to determine the appropriate amount of gas to charge for each operation.
In the YellowPaper, each opcode is defined to consume zero gas unless specified otherwise next to the semantics of the opcode (appendix H).</p>
<ul>
<li><code>#memory</code> computes the new memory size given the old size and next operator (with its arguments).</li>
<li><code>#memoryUsageUpdate</code> is the function <code>M</code> in appendix H of the YellowPaper which helps track the memory used.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #memory <span class="token punctuation">(</span> OpCode <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#memory<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> MLOAD INDEX        <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> MSTORE INDEX _     <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> MSTORE8 INDEX _    <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> MCOPY DST SRC WIDTH<span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> maxInt<span class="token punctuation">(</span>DST<span class="token punctuation">,</span> SRC<span class="token punctuation">)</span><span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> SHA3 START WIDTH   <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> LOG<span class="token punctuation">(</span>_<span class="token punctuation">)</span> START WIDTH <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> CODECOPY START _ WIDTH       <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> EXTCODECOPY _ START _ WIDTH  <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> CALLDATACOPY START _ WIDTH   <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> RETURNDATACOPY START _ WIDTH <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> CREATE  _ START WIDTH   <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> CREATE2 _ START WIDTH _ <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> RETURN START WIDTH      <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> REVERT START WIDTH      <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> _COP<span class="token punctuation">:</span>CallOp     _ _ _ ARGSTART ARGWIDTH RETSTART RETWIDTH <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>#memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span><span class="token punctuation">,</span> RETSTART<span class="token punctuation">,</span> RETWIDTH<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> _CSOP<span class="token punctuation">:</span>CallSixOp _ _   ARGSTART ARGWIDTH RETSTART RETWIDTH <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #memoryUsageUpdate<span class="token punctuation">(</span>#memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> ARGSTART<span class="token punctuation">,</span> ARGWIDTH<span class="token punctuation">)</span><span class="token punctuation">,</span> RETSTART<span class="token punctuation">,</span> RETWIDTH<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #memory <span class="token punctuation">(</span> _ <span class="token punctuation">,</span> MU <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MU <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #usesMemory <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#usesMemory<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>_<span class="token punctuation">:</span>LogOp<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>_<span class="token punctuation">:</span>CallOp<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>_<span class="token punctuation">:</span>CallSixOp<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>MLOAD<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>MSTORE<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>MSTORE8<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>SHA3<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>CODECOPY<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>EXTCODECOPY<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>CALLDATACOPY<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>RETURNDATACOPY<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>CREATE<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>CREATE2<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>RETURN<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>REVERT<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>MCOPY<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesMemory<span class="token punctuation">(</span>_<span class="token punctuation">)</span>              <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Int</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #memoryUsageUpdate <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#memoryUsageUpdate<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span>     _<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MU                                       <span class="token keyword">requires</span> notBool <span class="token number">0</span> &lt;<span class="token keyword">Int</span> WIDTH <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>
    <span class="token keyword">rule</span> #memoryUsageUpdate<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> START<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> maxInt<span class="token punctuation">(</span>MU<span class="token punctuation">,</span> <span class="token punctuation">(</span>START <span class="token operator">+</span><span class="token keyword">Int</span> WIDTH<span class="token punctuation">)</span> up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">requires</span>         <span class="token number">0</span> &lt;<span class="token keyword">Int</span> WIDTH <span class="token punctuation">[</span>concrete<span class="token punctuation">]</span>
</code></pre>
<h2 id="access-list-gas">Access List Gas</h2>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #usesAccessList <span class="token punctuation">(</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#usesAccessList<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #usesAccessList<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> <span class="token boolean">true</span>  <span class="token keyword">requires</span> isAddr1Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #usesAccessList<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> <span class="token boolean">true</span>  <span class="token keyword">requires</span> isAddr2Op<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #usesAccessList<span class="token punctuation">(</span>SLOAD<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesAccessList<span class="token punctuation">(</span>SSTORE<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #usesAccessList<span class="token punctuation">(</span>_<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#access"</span> <span class="token string">"["</span> OpCode <span class="token string">","</span> OpCode <span class="token string">"]"</span>
 <span class="token comment">// ---------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #access <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> AOP <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> AOP<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductGas <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghasaccesslist &lt;&lt; SCHED &gt;&gt; andBool #usesAccessList<span class="token punctuation">(</span>OP<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #access <span class="token punctuation">[</span> OP <span class="token punctuation">,</span> _ <span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool <span class="token punctuation">(</span>Ghasaccesslist &lt;&lt; SCHED &gt;&gt; andBool #usesAccessList<span class="token punctuation">(</span>OP<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #gasAccess <span class="token punctuation">(</span> Schedule<span class="token punctuation">,</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#gasAccess<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODESIZE ACCT<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Caddraccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ACCT in ACCTS<span class="token punctuation">)</span>                                                                   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODECOPY ACCT _ _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Caddraccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ACCT in ACCTS<span class="token punctuation">)</span>                                                                   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODEHASH ACCT<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Caddraccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ACCT in ACCTS<span class="token punctuation">)</span>                                                                   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BALANCE ACCT<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> Caddraccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ACCT in ACCTS<span class="token punctuation">)</span>                                                                   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SELFDESTRUCT ACCT<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> #if ACCT in ACCTS #then <span class="token number">0</span> #else Gcoldaccountaccess &lt; SCHED &gt; #fi                                    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>_    <span class="token punctuation">,</span> SLOAD INDEX <span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> #accessStorage ACCT INDEX <span class="token operator">~&gt;</span> <span class="token number">0</span>                                                                      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SSTORE INDEX _<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> #accessStorage ACCT INDEX <span class="token operator">~&gt;</span> #if #inStorage<span class="token punctuation">(</span>TS<span class="token punctuation">,</span> ACCT<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span> #then <span class="token number">0</span> #else Gcoldsload &lt; SCHED &gt; #fi <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedStorage</span><span class="token punctuation">&gt;</span></span> TS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasAccess<span class="token punctuation">(</span>_    <span class="token punctuation">,</span> _ <span class="token punctuation">)</span>                     <span class="token operator">=&gt;</span> <span class="token number">0</span>                                                                                                   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

</code></pre>
<h2 id="execution-gas">Execution Gas</h2>
<p>The intrinsic gas calculation mirrors the style of the YellowPaper (appendix H).</p>
<ul>
<li>
<p><code>#gasExec</code> loads all the relevant surrounding state and uses that to compute the intrinsic execution gas of each opcode.</p>
</li>
<li>
<p>Gas cost for <code>TSTORE</code> is the same as a warm <code>SSTORE</code> of a dirty slot (i.e. original value is not new value, original is not current value, currently 100 gas).</p>
</li>
<li>
<p>Gas cost of <code>TLOAD</code> is the same as a hot <code>SLOAD</code> (value has been read before, currently 100 gas).</p>
</li>
<li>
<p>Gas cost cannot be on par with memory access due to transient storage’s interactions with reverts.</p>
</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #gasExec <span class="token punctuation">(</span> Schedule <span class="token punctuation">,</span> OpCode <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#gasExec<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -----------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> TLOAD _   <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gwarmstorageread &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> TSTORE _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gwarmstoragedirtystore &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SSTORE INDEX NEW<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Csstore<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> NEW<span class="token punctuation">,</span> #lookup<span class="token punctuation">(</span>STORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span><span class="token punctuation">,</span> #lookup<span class="token punctuation">(</span>ORIGSTORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>storage</span><span class="token punctuation">&gt;</span></span> STORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>storage</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>origStorage</span><span class="token punctuation">&gt;</span></span> ORIGSTORAGE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>origStorage</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span> R <span class="token operator">=&gt;</span> R <span class="token operator">+</span><span class="token keyword">Int</span> Rsstore<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> NEW<span class="token punctuation">,</span> #lookup<span class="token punctuation">(</span>STORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span><span class="token punctuation">,</span> #lookup<span class="token punctuation">(</span>ORIGSTORAGE<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool Ghassstorestipend &lt;&lt; SCHED &gt;&gt;
        orBool notBool GAVAIL <span class="token operator">&lt;=</span>Gas Gcallstipend &lt; SCHED &gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SSTORE _ _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #end EVMC_OUT_OF_GAS <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> Ghassstorestipend &lt;&lt; SCHED &gt;&gt;
       andBool GAVAIL <span class="token operator">&lt;=</span>Gas Gcallstipend &lt; SCHED &gt;

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXP _ W1<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gexp &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>                                                         <span class="token keyword">requires</span> W1 <span class="token operator">&lt;=</span><span class="token keyword">Int</span> <span class="token number">0</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXP _ W1<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gexp &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gexpbyte &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>log256Int<span class="token punctuation">(</span>W1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">requires</span> <span class="token number">0</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Int</span> <span class="token attr-name">W1</span> <span class="token attr-name">[preserves-definedness]</span>

    <span class="token attr-name">rule</span> <span class="token attr-name">&lt;k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLDATACOPY    _ _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gcopy &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> RETURNDATACOPY  _ _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gcopy &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CODECOPY        _ _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gcopy &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MCOPY           _ _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gcopy &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> LOG<span class="token punctuation">(</span>N<span class="token punctuation">)</span> _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Glog &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Glogdata &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> WIDTH<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>N <span class="token operator">*</span><span class="token keyword">Int</span> Glogtopic &lt; SCHED &gt;<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALL GCAP ACCTTO VALUE _ _ _ _<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Ccallgas<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #allocateCallGas
          <span class="token operator">~&gt;</span> Ccall<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLCODE GCAP ACCTTO VALUE _ _ _ _<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Ccallgas<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTFROM<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #allocateCallGas
          <span class="token operator">~&gt;</span> Ccall<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTFROM<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> DELEGATECALL GCAP ACCTTO _ _ _ _<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Ccallgas<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTFROM<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #allocateCallGas
          <span class="token operator">~&gt;</span> Ccall<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTFROM<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> STATICCALL GCAP ACCTTO _ _ _ _<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Ccallgas<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #allocateCallGas
          <span class="token operator">~&gt;</span> Ccall<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ACCTTO in ACCTS<span class="token punctuation">,</span> #accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span> GAVAIL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SELFDESTRUCT ACCTTO<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Cselfdestruct<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #accountNonexistent<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span><span class="token punctuation">,</span> BAL<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selfDestruct</span><span class="token punctuation">&gt;</span></span> SDS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selfDestruct</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refund</span><span class="token punctuation">&gt;</span></span> RF <span class="token operator">=&gt;</span> #if ACCTFROM in SDS #then RF #else RF <span class="token operator">+</span>Word Rselfdestruct &lt; SCHED &gt; #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>refund</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTFROM <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CREATE _ _ WIDTH<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Gcreate &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> Cinitcode<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductGas
          <span class="token operator">~&gt;</span> #allocateCreateGas <span class="token operator">~&gt;</span> <span class="token number">0</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CREATE2 _ _ WIDTH _<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Gcreate &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> Gsha3word &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token keyword">Int</span> Cinitcode<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token operator">~&gt;</span> #deductGas
          <span class="token operator">~&gt;</span> #allocateCreateGas <span class="token operator">~&gt;</span> <span class="token number">0</span>
         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SHA3 _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gsha3 &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>Gsha3word &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>WIDTH up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> JUMPDEST<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> Gjumpdest &lt; SCHED &gt;                        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SLOAD INDEX<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Csload<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> #inStorage<span class="token punctuation">(</span>TS<span class="token punctuation">,</span> ACCT<span class="token punctuation">,</span> INDEX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedStorage</span><span class="token punctuation">&gt;</span></span> TS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedStorage</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Wzero</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> STOP<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gzero &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> RETURN _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gzero &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> REVERT _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gzero &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Wbase</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ADDRESS<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ORIGIN<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLER<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLVALUE<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLDATASIZE<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> RETURNDATASIZE<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CODESIZE<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GASPRICE<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> COINBASE<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> TIMESTAMP<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> NUMBER<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> DIFFICULTY<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> PREVRANDAO<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GASLIMIT<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BASEFEE<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLOBBASEFEE<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> POP _<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> PC<span class="token punctuation">)</span>             <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> PUSHZERO<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MSIZE<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GAS<span class="token punctuation">)</span>            <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CHAINID<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gbase &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Wverylow</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ADD _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SUB _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> NOT _<span class="token punctuation">)</span>          <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> LT _ _<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GT _ _<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SLT _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SGT _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EQ _ _<span class="token punctuation">)</span>         <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISZERO _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> AND _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EVMOR _ _<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> XOR _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BYTE _ _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SHL _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SHR _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SAR _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> CALLDATALOAD _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MLOAD _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MSTORE _ _<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MSTORE8 _ _<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> PUSH<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> DUP<span class="token punctuation">(</span>_<span class="token punctuation">)</span> _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SWAP<span class="token punctuation">(</span>_<span class="token punctuation">)</span> _<span class="token punctuation">)</span>      <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLOBHASH _<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gverylow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Wlow</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MUL _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> DIV _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SDIV _ _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MOD _ _<span class="token punctuation">)</span>        <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SMOD _ _<span class="token punctuation">)</span>       <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SIGNEXTEND _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> SELFBALANCE<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> Glow &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Wmid</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ADDMOD _ _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gmid &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MULMOD _ _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gmid &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> JUMP _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gmid &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Whigh</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> JUMPI _ _<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Ghigh &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODECOPY _ _ _ WIDTH<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Cextcodecopy<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODESIZE _<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> Cextcodesize<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BALANCE _<span class="token punctuation">)</span>               <span class="token operator">=&gt;</span> Cbalance<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> EXTCODEHASH _<span class="token punctuation">)</span>           <span class="token operator">=&gt;</span> Cextcodehash<span class="token punctuation">(</span>SCHED<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLOCKHASH _<span class="token punctuation">)</span>             <span class="token operator">=&gt;</span> Gblockhash &lt; SCHED &gt;       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// Precompiled</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>_<span class="token punctuation">,</span> ECREC<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> <span class="token number">3000</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>_<span class="token punctuation">,</span> SHA256<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  <span class="token number">60</span> <span class="token operator">+</span><span class="token keyword">Int</span>  <span class="token number">12</span> <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>_<span class="token punctuation">,</span> RIP160<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">600</span> <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token number">120</span> <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>_<span class="token punctuation">,</span> ID<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span>  <span class="token number">15</span> <span class="token operator">+</span><span class="token keyword">Int</span>   <span class="token number">3</span> <span class="token operator">*</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> up<span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> MODEXP<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Cmodexp<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> DATA<span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ECADD<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gecadd &lt; SCHED&gt;  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ECMUL<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gecmul &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ECPAIRING<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gecpairconst &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> <span class="token punctuation">(</span>lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">192</span><span class="token punctuation">)</span> <span class="token operator">*</span><span class="token keyword">Int</span> Gecpaircoeff &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLAKE2F<span class="token punctuation">)</span>   <span class="token operator">=&gt;</span> Gfround &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> #asWord<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>DATA<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> KZGPOINTEVAL<span class="token punctuation">)</span>  <span class="token operator">=&gt;</span> Gpointeval &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_G1ADD<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gbls12g1add &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_G1MSM<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #let N <span class="token operator">=</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">160</span> #in N <span class="token operator">*</span><span class="token keyword">Int</span> Gbls12g1mul &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> Cbls12g1MsmDiscount<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">1000</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_G2ADD<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Gbls12g2add &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_G2MSM<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #let N <span class="token operator">=</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">288</span> #in N <span class="token operator">*</span><span class="token keyword">Int</span> Gbls12g2mul &lt; SCHED &gt; <span class="token operator">*</span><span class="token keyword">Int</span> Cbls12g2MsmDiscount<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">1000</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_PAIRING_CHECK<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #let N <span class="token operator">=</span> lengthBytes<span class="token punctuation">(</span>DATA<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token keyword">Int</span> <span class="token number">384</span> #in N <span class="token operator">*</span><span class="token keyword">Int</span> Gbls12PairingCheckMul &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> Gbls12PairingCheckAdd &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callData</span><span class="token punctuation">&gt;</span></span> DATA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callData</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_MAP_FP_TO_G1<span class="token punctuation">)</span>     <span class="token operator">=&gt;</span> Gbls12mapfptog1 &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #gasExec<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> BLS12_MAP_FP2_TO_G2<span class="token punctuation">)</span>    <span class="token operator">=&gt;</span> Gbls12mapfp2tog2 &lt; SCHED &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#allocateCallGas"</span>
 <span class="token comment">// ----------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> GCALL<span class="token punctuation">:</span>Gas <span class="token operator">~&gt;</span> #allocateCallGas <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> _ <span class="token operator">=&gt;</span> GCALL <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> InternalOp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">"#allocateCreateGas"</span>
 <span class="token comment">// ------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #allocateCreateGas <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>K <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>gas</span><span class="token punctuation">&gt;</span></span>     GAVAIL <span class="token operator">=&gt;</span> #if Gstaticcalldepth &lt;&lt; SCHED &gt;&gt; #then <span class="token number">0</span>      #else GAVAIL <span class="token operator">/</span>Gas <span class="token number">64</span>      #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>gas</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>callGas</span><span class="token punctuation">&gt;</span></span> _      <span class="token operator">=&gt;</span> #if Gstaticcalldepth &lt;&lt; SCHED &gt;&gt; #then GAVAIL #else #allBut64th<span class="token punctuation">(</span>GAVAIL<span class="token punctuation">)</span> #fi <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>callGas</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">[</span>preserves<span class="token operator">-</span>definedness<span class="token punctuation">]</span>
</code></pre>
<p>There are several helpers for calculating gas (most of them also specified in the YellowPaper).</p>
<pre><code class="language-k">    <span class="token keyword">syntax</span> Exp     <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span> <span class="token operator">|</span> Gas
    <span class="token keyword">syntax</span> KResult <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Int</span>
    <span class="token keyword">syntax</span> Exp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> Ccall         <span class="token punctuation">(</span> Schedule <span class="token punctuation">,</span> BExp <span class="token punctuation">,</span> Gas <span class="token punctuation">,</span> Gas <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>Ccall<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">strict</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> Ccallgas      <span class="token punctuation">(</span> Schedule <span class="token punctuation">,</span> BExp <span class="token punctuation">,</span> Gas <span class="token punctuation">,</span> Gas <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">,</span> <span class="token keyword">Bool</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>Ccallgas<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">strict</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                 <span class="token operator">|</span> Cselfdestruct <span class="token punctuation">(</span> Schedule <span class="token punctuation">,</span> BExp <span class="token punctuation">,</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span>                                  <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>Cselfdestruct<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">strict</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// --------------------------------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> Ccall<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">:</span><span class="token keyword">Bool</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ISWARM<span class="token punctuation">,</span> ISDELEGATION<span class="token punctuation">,</span> ISWARMDELEGATION<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Cextra<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ISWARM<span class="token punctuation">,</span> ISDELEGATION<span class="token punctuation">,</span> ISWARMDELEGATION<span class="token punctuation">)</span> <span class="token operator">+</span>Gas Cgascap<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> Cextra<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ISWARM<span class="token punctuation">,</span> ISDELEGATION<span class="token punctuation">,</span> ISWARMDELEGATION<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> Ccallgas<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">:</span><span class="token keyword">Bool</span><span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ISWARM<span class="token punctuation">,</span> ISDELEGATION<span class="token punctuation">,</span> ISWARMDELEGATION<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Cgascap<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> GCAP<span class="token punctuation">,</span> GAVAIL<span class="token punctuation">,</span> Cextra<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> ISWARM<span class="token punctuation">,</span> ISDELEGATION<span class="token punctuation">,</span> ISWARMDELEGATION<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>Gas #if VALUE <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">0</span> #then <span class="token number">0</span> #else Gcallstipend &lt; SCHED &gt; #fi <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> Cselfdestruct<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY<span class="token punctuation">:</span><span class="token keyword">Bool</span><span class="token punctuation">,</span> BAL<span class="token punctuation">)</span>
          <span class="token operator">=&gt;</span> Gselfdestruct &lt; SCHED &gt; <span class="token operator">+</span><span class="token keyword">Int</span> Cnew<span class="token punctuation">(</span>SCHED<span class="token punctuation">,</span> ISEMPTY andBool Gselfdestructnewaccount &lt;&lt; SCHED &gt;&gt;<span class="token punctuation">,</span> BAL<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>

    <span class="token keyword">syntax</span> BExp    <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Bool</span>
    <span class="token keyword">syntax</span> KResult <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> <span class="token keyword">Bool</span>
    <span class="token keyword">syntax</span> BExp <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #accountNonexistent <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#accountNonexistent<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accountNonexistent<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> #accountEmpty<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span> NONCE<span class="token punctuation">,</span> BAL<span class="token punctuation">)</span> andBool Gemptyisnonexistent &lt;&lt; SCHED &gt;&gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span>  ACCT  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>balance</span><span class="token punctuation">&gt;</span></span> BAL   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>balance</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nonce</span><span class="token punctuation">&gt;</span></span>   NONCE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nonce</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span>    CODE  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>

   <span class="token keyword">rule</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>k</span><span class="token punctuation">&gt;</span></span> #accountNonexistent<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>k</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h1 id="processing-setcode-transaction-authority-entries">Processing SetCode Transaction Authority Entries</h1>
<ul>
<li><code>#isValidDelegation</code> - checks whether the code of an account is a valid delegation designation with the delegation marker prefix (<code>0xef0100</code>) and a length of 23 bytes.</li>
<li><code>#accountHasAuthority</code> - returns wether the code of a given account is a valid delegation according to EIP-7702.</li>
<li><code>#accountAuthorityIsWarm</code> - for a given account, check if the delegated address inside the account code is present in <code>accessed_accounts</code>, returning <code>false</code> if the code is a non valid delegation.</li>
<li><code>#checkAuthorityList</code> - check if the authority list of a SetCode type transaction is valid.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #isValidDelegation <span class="token punctuation">(</span> Bytes <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#isValidDelegation<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #isValidDelegation<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token keyword">requires</span> #range<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span>K EOA_DELEGATION_MARKER andBool lengthBytes<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">23</span>
    <span class="token keyword">rule</span> #isValidDelegation<span class="token punctuation">(</span>_   <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #accountHasAuthority <span class="token punctuation">(</span> Account <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#accountHasAuthority<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>#accountHasAuthority<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #isValidDelegation<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #accountHasAuthority<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #accountAuthorityIsWarm <span class="token punctuation">(</span> Account <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#accountAuthorityIsWarm<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------------------------</span>
     <span class="token keyword">rule</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>#accountAuthorityIsWarm<span class="token punctuation">(</span>ACCTTO<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCTTO <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span> ACCTS <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accessedAccounts</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> #isValidDelegation<span class="token punctuation">(</span>CODE<span class="token punctuation">)</span>
       andBool <span class="token punctuation">(</span>#asAccount<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> in ACCTS orBool #asAccount<span class="token punctuation">(</span>#range<span class="token punctuation">(</span>CODE<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span>K ACCTTO<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #accountAuthorityIsWarm<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #checkAuthorityList <span class="token punctuation">(</span> List <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#checkAuthorityList<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// -------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #checkAuthorityList <span class="token punctuation">(</span><span class="token punctuation">.</span>List<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span>
    <span class="token keyword">rule</span> #checkAuthorityList <span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>ListItem<span class="token punctuation">(</span>CID<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>ADDR<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>NONCE<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>YPAR<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>SIGR<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span> ListItem<span class="token punctuation">(</span>SIGS<span class="token punctuation">:</span>Bytes<span class="token punctuation">)</span><span class="token punctuation">)</span> REST <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> andBool #checkAuthorityList<span class="token punctuation">(</span>REST<span class="token punctuation">)</span>
      <span class="token keyword">requires</span> #rangeUInt<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>CID<span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
       andBool #rangeUInt<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>NONCE<span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
       andBool lengthBytes<span class="token punctuation">(</span>ADDR<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">Int</span> <span class="token number">20</span>
       andBool #rangeUInt<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>YPAR<span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
       andBool #rangeUInt<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>SIGR<span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>
       andBool #rangeUInt<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> Bytes2Int<span class="token punctuation">(</span>SIGS<span class="token punctuation">,</span> BE<span class="token punctuation">,</span> Unsigned<span class="token punctuation">)</span><span class="token punctuation">)</span>

   <span class="token keyword">rule</span> #checkAuthorityList<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
</code></pre>
<h1 id="account-helper-functions">Account helper functions</h1>
<ul>
<li><code>#getAccountCode(Account)</code> - K function to retrieve the code of an account, returning the empty bytes object if the account is not in the state.</li>
<li><code>#accountExists(Account)</code> - Function that checks if an account is present in the state.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> Bytes <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #getAccountCode <span class="token punctuation">(</span> Account <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#getAccountCode<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> #getAccountCode<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CODE <span class="token punctuation">]</span><span class="token punctuation">]</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedule</span><span class="token punctuation">&gt;</span></span> SCHED <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedule</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span> CODE <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
      <span class="token keyword">requires</span> notBool #isPrecompiledAccount<span class="token punctuation">(</span>ACCT<span class="token punctuation">,</span> SCHED<span class="token punctuation">)</span>

    <span class="token keyword">rule</span> #getAccountCode<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">.</span>Bytes <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

    <span class="token keyword">syntax</span> <span class="token keyword">Bool</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #accountExists <span class="token punctuation">(</span> Account <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#accountExists<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> #accountExists<span class="token punctuation">(</span>ACCT<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acctID</span><span class="token punctuation">&gt;</span></span> ACCT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>acctID</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">rule</span> #accountExists<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">false</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>

</code></pre>
<h1 id="evm-program-representations">EVM Program Representations</h1>
<p>EVM programs are represented algebraically in K, but programs can load and manipulate program data directly.
The opcodes <code>CODECOPY</code> and <code>EXTCODECOPY</code> rely on the assembled form of the programs being present.
The opcode <code>CREATE</code> relies on being able to interpret EVM data as a program.</p>
<p>This is a program representation dependence, which we might want to avoid.
Perhaps the only program representation dependence we should have is the hash of the program; doing so achieves:</p>
<ul>
<li>Program representation independence (different analysis tools on the language don't have to ensure they have a common representation of programs, just a common interpretation of the data-files holding programs).</li>
<li>Programming language independence (we wouldn't even have to commit to a particular language or interpretation of the data-file).</li>
<li>Only depending on the hash allows us to know that we have <em>exactly</em> the correct data-file (program), and nothing more.</li>
</ul>
<h2 id="disassembler">Disassembler</h2>
<p>After interpreting the strings representing programs as a <code>WordStack</code>, it should be changed into an <code>OpCodes</code> for use by the EVM semantics.</p>
<ul>
<li><code>#dasmOpCode</code> interprets a <code>Int</code> as an <code>OpCode</code>.</li>
</ul>
<pre><code class="language-k">    <span class="token keyword">syntax</span> OpCode <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">=</span> #dasmOpCode <span class="token punctuation">(</span> <span class="token keyword">Int</span> <span class="token punctuation">,</span> Schedule <span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">symbol</span><span class="token punctuation">(</span>#dasmOpCode<span class="token punctuation">)</span><span class="token punctuation">,</span> function<span class="token punctuation">,</span> memo<span class="token punctuation">,</span> total<span class="token punctuation">]</span>
 <span class="token comment">// ---------------------------------------------------------------------------------------------</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">0</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> STOP
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">1</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ADD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">2</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MUL
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">3</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SUB
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">4</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DIV
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">5</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SDIV
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">6</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MOD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">7</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SMOD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">8</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ADDMOD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   <span class="token number">9</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MULMOD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">10</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EXP
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">11</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SIGNEXTEND
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">16</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">17</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> GT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">18</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SLT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">19</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SGT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">20</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EQ
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">21</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ISZERO
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">22</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> AND
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">23</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EVMOR
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">24</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> XOR
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">25</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> NOT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">26</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BYTE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">27</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SHL <span class="token keyword">requires</span> Ghasshift &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">28</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SHR <span class="token keyword">requires</span> Ghasshift &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">29</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SAR <span class="token keyword">requires</span> Ghasshift &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">32</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SHA3
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">48</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ADDRESS
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">49</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BALANCE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">50</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ORIGIN
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">51</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLER
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">52</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLVALUE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">53</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLDATALOAD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">54</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLDATASIZE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">55</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLDATACOPY
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">56</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CODESIZE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">57</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CODECOPY
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">58</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> GASPRICE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">59</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EXTCODESIZE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">60</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EXTCODECOPY
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">61</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> RETURNDATASIZE <span class="token keyword">requires</span> Ghasreturndata  &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">62</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> RETURNDATACOPY <span class="token keyword">requires</span> Ghasreturndata  &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">63</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> EXTCODEHASH    <span class="token keyword">requires</span> Ghasextcodehash &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">64</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLOCKHASH
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">65</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> COINBASE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">66</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> TIMESTAMP
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">67</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> NUMBER
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">68</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PREVRANDAO  <span class="token keyword">requires</span>         Ghasprevrandao &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">68</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DIFFICULTY  <span class="token keyword">requires</span> notBool Ghasprevrandao &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">69</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> GASLIMIT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">70</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CHAINID     <span class="token keyword">requires</span> Ghaschainid     &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">71</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SELFBALANCE <span class="token keyword">requires</span> Ghasselfbalance &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">72</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BASEFEE     <span class="token keyword">requires</span> Ghasbasefee     &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">73</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLOBHASH    <span class="token keyword">requires</span> Ghasblobhash    &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">74</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> BLOBBASEFEE <span class="token keyword">requires</span> Ghasblobbasefee &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">80</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> POP
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">81</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MLOAD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">82</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MSTORE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">83</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MSTORE8
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">84</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SLOAD
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">85</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SSTORE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">86</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> JUMP
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">87</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> JUMPI
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">88</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PC
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">89</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MSIZE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">90</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> GAS
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">91</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> JUMPDEST
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">92</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> TLOAD    <span class="token keyword">requires</span> Ghastransient &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">93</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> TSTORE   <span class="token keyword">requires</span> Ghastransient &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">94</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> MCOPY    <span class="token keyword">requires</span> Ghasmcopy     &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">95</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSHZERO <span class="token keyword">requires</span> Ghaspushzero  &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">96</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">97</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">98</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>  <span class="token number">99</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">101</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">102</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">103</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">104</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">105</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">106</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">107</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">108</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">109</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">110</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">111</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">112</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">113</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">114</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">115</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">116</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">117</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">118</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">119</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">120</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">121</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">122</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">123</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">124</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">125</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">126</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">127</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PUSH<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">128</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">129</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">130</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">131</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">132</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">133</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">134</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">135</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">136</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">137</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">138</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">139</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">140</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">141</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">142</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">143</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DUP<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">144</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">145</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">146</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">147</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">148</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">149</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">150</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">151</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">152</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">153</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">154</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">155</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">156</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">157</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">158</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">159</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SWAP<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">160</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LOG<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">161</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LOG<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">162</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LOG<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">163</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LOG<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">164</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LOG<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">240</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CREATE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">241</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALL
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">242</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CALLCODE
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">243</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> RETURN
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">244</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DELEGATECALL <span class="token keyword">requires</span> SCHED <span class="token operator">=</span><span class="token operator">/</span><span class="token operator">=</span>K FRONTIER
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">245</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> CREATE2      <span class="token keyword">requires</span> Ghascreate2    &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">250</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> STATICCALL   <span class="token keyword">requires</span> Ghasstaticcall &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">253</span><span class="token punctuation">,</span> SCHED <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> REVERT       <span class="token keyword">requires</span> Ghasrevert     &lt;&lt; SCHED &gt;&gt;
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">254</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> INVALID
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span> <span class="token number">255</span><span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> SELFDESTRUCT
    <span class="token keyword">rule</span> #dasmOpCode<span class="token punctuation">(</span>   W<span class="token punctuation">,</span>     _ <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> UNDEFINED<span class="token punctuation">(</span>W<span class="token punctuation">)</span> <span class="token punctuation">[</span>owise<span class="token punctuation">]</span>
<span class="token keyword">endmodule</span>
</code></pre>
</body></html></div>
        </main>

        <!-- Page ToC -->
        <div class="col-12 col-md-3 col-xl-2 py-md-3 bd-sidebar page-toc mb-3">
          
<div>
<details style="padding:0.25rem 0;;padding-left: 0px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#evm-execution" class="bd-toc-link">EVM Execution</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#configuration"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Configuration
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#modal-semantics"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Modal Semantics
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#state-stacks" class="bd-toc-link">State Stacks</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#the-callstack"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                The CallStack
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#the-statestack"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                The StateStack
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#control-flow" class="bd-toc-link">Control Flow</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#exception-based"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Exception Based
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#opcode-execution" class="bd-toc-link">OpCode Execution</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#execution-macros"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Execution Macros
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#single-step"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Single Step
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#exceptional-checks"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Exceptional Checks
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#execution-step"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Execution Step
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#address-conversion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Address Conversion
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#program-counter"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Program Counter
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#fetching-requests-from-event-logs"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Fetching requests from event logs
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#blobs"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Blobs
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#block-processing"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Block processing
              </a></div>
            </div>
          </details>
        
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 0px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#evm-programs" class="bd-toc-link">EVM Programs</a>
              </summary>
            <div>
              <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#evm-opcodes" class="bd-toc-link">EVM OpCodes</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#internal-operations"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Internal Operations
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#invalid-operator"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Invalid Operator
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#stack-manipulations"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Stack Manipulations
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#local-memory"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Local Memory
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#expressions"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Expressions
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#local-state"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Local State
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#evm-opcodes-1" class="bd-toc-link">EVM OpCodes</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#evm-control-flow"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                EVM Control Flow
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#stop%2C-revert%2C-and-return"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                <code>STOP</code>, <code>REVERT</code>, and <code>RETURN</code>
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#call-data"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Call Data
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#return-data"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Return Data
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#log-operations"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Log Operations
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#ethereum-network-opcodes" class="bd-toc-link">Ethereum Network OpCodes</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#account-queries"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Account Queries
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#account-storage-operations"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Account Storage Operations
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#call-operations"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Call Operations
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#system-calls"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                System Calls
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#system-call-operations"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                System Call Operations
              </a></div><details style="padding:0.25rem 0;;padding-left: 8px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#ethereum-network-opcodes-1" class="bd-toc-link">Ethereum Network OpCodes</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#call-operations-1"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Call Operations
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#account-creation%2Fdeletion"
                class="bd-toc-link"
                style="padding-left: 16px;;"
              >
                Account Creation/Deletion
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#precompiled-contracts"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Precompiled Contracts
              </a></div>
            </div>
          </details>
        <details style="padding:0.25rem 0;;padding-left: 0px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#ethereum-gas-calculation" class="bd-toc-link">Ethereum Gas Calculation</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#overall-gas"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Overall Gas
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#memory-consumption"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Memory Consumption
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#access-list-gas"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Access List Gas
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#execution-gas"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Execution Gas
              </a></div>
            </div>
          </details>
        <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#processing-setcode-transaction-authority-entries"
                class="bd-toc-link"
                style="padding-left: 0px;;"
              >
                Processing SetCode Transaction Authority Entries
              </a></div><div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#account-helper-functions"
                class="bd-toc-link"
                style="padding-left: 0px;;"
              >
                Account helper functions
              </a></div><details style="padding:0.25rem 0;;padding-left: 0px;">
            <summary class="bd-toc-link-wrapper">
              <a href="#evm-program-representations" class="bd-toc-link">EVM Program Representations</a>
              </summary>
            <div>
              <div class="bd-toc-link-wrapper" style="padding:0.25rem 0;">
              <a
                href="#disassembler"
                class="bd-toc-link"
                style="padding-left: 8px;;"
              >
                Disassembler
              </a></div>
            </div>
          </details>
        
</div>

        </div>
        <div class="btn btn-rv-blue page-toc-toggle-btn"></div>
        <!-- End Page ToC -->
      </div>
    </div>
<!-- The footer is now controlled by the k-web-theme git submodule -->
<footer id="rvsite-footer" class="app-footer text-md-left text-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-4 mb-md-0 mb-4">
        <a href="https://runtimeverification.com/" target="_blank">
          <picture>
            <source
              srcset="
                https://runtimeverification.com/assets/img/rv-logo-dark.png
              "
              media="(prefers-color-scheme: dark)"
            />
            <img
              class="logo-dark"
              src="https://runtimeverification.com/assets/img/rv-logo.png"
              alt="Runtime Verification logo"
              style="height: 32px"
            /> </picture
        ></a>
        <p class="mt-2 text-md-left copyright">
          <a href="https://maps.app.goo.gl/8YhKozfmZtgzQBsH7" target="_blank"
            >202 S Broadway Ave #31, Urbana, IL</a
          >
        </p>
      </div>
      <div class="col-md-4 text-md-center mb-md-0 mb-4"></div>
      <div class="col-md-4 mb-md-0 mb-4 pl-0 text-md-right">
        <p class="copyright">2025 © all rights reserved</p>
        <span class="copyright"
          ><a href="https://runtimeverification.com/privacy-policy"
            >privacy policy</a
          >
          |
          <a href="https://runtimeverification.com/terms-of-use"
            >terms of use</a
          ></span
        >
      </div>
    </div>
  </div>
</footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Typist/1.2/typist.min.js"></script>
    <script src="../../../../../../assets/js/index.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-QL0D8HRYFW"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "G-QL0D8HRYFW");
</script>

  </body>
</html>
